


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta name="robots" content="noindex">
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>torch._logging._internal &mdash; PyTorch main documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://pytorch.org/docs/stable/_modules/torch/_logging/_internal.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/katex-math.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sphinx-dropdown.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/panels-bootstrap.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/jit.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />

<!--
  Search engines should not index the main version of documentation.
  Stable documentation are built without release == 'main'.
-->
<meta name="robots" content="noindex">


  <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T8XT4PS');</script>
    <!-- End Google Tag Manager -->
  


  
  <script src="../../../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="active docs-active">
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Docs
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
                  <span class="dropdown-title">PyTorch</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/audio/stable/index.html">
                  <span class="dropdown-title">torchaudio</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/text/stable/index.html">
                  <span class="dropdown-title">torchtext</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/vision/stable/index.html">
                  <span class="dropdown-title">torchvision</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/torcharrow">
                  <span class="dropdown-title">torcharrow</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/data">
                  <span class="dropdown-title">TorchData</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/torchrec">
                  <span class="dropdown-title">TorchRec</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/serve/">
                  <span class="dropdown-title">TorchServe</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/torchx/">
                  <span class="dropdown-title">TorchX</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/xla">
                  <span class="dropdown-title">PyTorch on XLA Devices</span>
                  <p></p>
                </a>
            </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/features">
                  <span class="dropdown-title">About</span>
                  <p>Learn about PyTorchâ€™s features and capabilities</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/foundation">
                  <span class="dropdown-title">PyTorch Foundation</span>
                  <p>Learn about the PyTorch foundation</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/#community-module">
                  <span class="dropdown-title">Community</span>
                  <p>Join the PyTorch developer community to contribute, learn, and get your questions answered.</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/community-stories">
                  <span class="dropdown-title">Community Stories</span>
                  <p>Learn how our community solves real, everyday machine learning problems with PyTorch.</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/resources">
                  <span class="dropdown-title">Developer Resources</span>
                  <p>Find resources and get questions answered</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/events">
                  <span class="dropdown-title">Events</span>
                  <p>Find events, webinars, and podcasts</p>
                </a>
                <a class="nav-dropdown-item" href="https://discuss.pytorch.org/" target="_blank">
                  <span class="dropdown-title">Forums</span>
                  <p>A place to discuss PyTorch code, issues, install, research</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/hub">
                  <span class="dropdown-title">Models (Beta)</span>
                  <p>Discover, publish, and reuse pre-trained models</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">GitHub</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            
    <div class="version">
      <a href='https://pytorch.org/docs/versions.html'>main (2.1.0a0+git707d265 ) &#x25BC</a>
    </div>
    


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          </div>

          

<div>
  <a style="color:#F05732" href="https://pytorch.org/docs/stable/_modules/torch/_logging/_internal.html">
    You are viewing unstable developer preview docs.
    Click here to view docs for latest stable release.
  </a>
</div>


            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../community/build_ci_governance.html">PyTorch Governance | Build + CI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../community/contribution_guide.html">PyTorch Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../community/design.html">PyTorch Design Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../community/governance.html">PyTorch Governance | Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../community/persons_of_interest.html">PyTorch Governance | Maintainers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/amp_examples.html">CUDA Automatic Mixed Precision examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/autograd.html">Autograd mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/broadcasting.html">Broadcasting semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/cpu_threading_torchscript_inference.html">CPU threading and TorchScript inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/cuda.html">CUDA semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/ddp.html">Distributed Data Parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/extending.html">Extending PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/extending.func.html">Extending torch.func with autograd.Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/gradcheck.html">Gradcheck mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/hip.html">HIP (ROCm) semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/large_scale_deployments.html">Features for large-scale deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/mps.html">MPS backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/multiprocessing.html">Multiprocessing best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/numerical_accuracy.html">Numerical accuracy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/randomness.html">Reproducibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/serialization.html">Serialization semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/windows.html">Windows FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">torch.compile</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/index.html">torch.compile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/get-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/troubleshooting.html">PyTorch 2.0 Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/technical-overview.html">Technical Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/guards-overview.html">Guards Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/custom-backends.html">Custom Backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/fine_grained_apis.html">TorchDynamo APIs to control fine-grained tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/profiling_torch_compile.html">Profiling to understand torch.compile performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/inductor_profiling.html">TorchInductor GPU Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/deep-dive.html">TorchDynamo Deeper Dive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/cudagraph_trees.html">CUDAGraph Trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/performance-dashboard.html">PyTorch 2.0 Performance Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/torchfunc-and-torchcompile.html">torch.func interaction with torch.compile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ir.html">IRs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/dynamic-shapes.html">Dynamic shapes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/fake-tensor.html">Fake tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../logging.html">torch._logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compile/transformations.html">Writing Graph Transformations on ATen IR</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Language Bindings</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../cpp_index.html">C++</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/javadoc/">Javadoc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../deploy.html">torch::deploy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../torch.html">torch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn.html">torch.nn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn.functional.html">torch.nn.functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tensors.html">torch.Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tensor_attributes.html">Tensor Attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tensor_view.html">Tensor Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../amp.html">torch.amp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autograd.html">torch.autograd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../library.html">torch.library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cuda.html">torch.cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mps.html">torch.mps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../backends.html">torch.backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../export.html">torch._export.export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../distributed.html">torch.distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../distributed.algorithms.join.html">torch.distributed.algorithms.join</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../distributed.elastic.html">torch.distributed.elastic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fsdp.html">torch.distributed.fsdp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../distributed.optim.html">torch.distributed.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../distributed.tensor.parallel.html">torch.distributed.tensor.parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../distributed.checkpoint.html">torch.distributed.checkpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../distributions.html">torch.distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compiler.html">torch.compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fft.html">torch.fft</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../func.html">torch.func</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../futures.html">torch.futures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fx.html">torch.fx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hub.html">torch.hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../jit.html">torch.jit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../linalg.html">torch.linalg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../monitor.html">torch.monitor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../signal.html">torch.signal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../special.html">torch.special</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../torch.overrides.html">torch.overrides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../package.html">torch.package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../profiler.html">torch.profiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn.init.html">torch.nn.init</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../onnx.html">torch.onnx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../onnx_diagnostics.html">torch.onnx diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../optim.html">torch.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../complex_numbers.html">Complex Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ddp_comm_hooks.html">DDP Communication Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pipeline.html">Pipeline Parallelism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quantization.html">Quantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rpc.html">Distributed RPC Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../random.html">torch.random</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../masked.html">torch.masked</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nested.html">torch.nested</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sparse.html">torch.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../storage.html">torch.Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../testing.html">torch.testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../benchmark_utils.html">torch.utils.benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../bottleneck.html">torch.utils.bottleneck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../checkpoint.html">torch.utils.checkpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cpp_extension.html">torch.utils.cpp_extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data.html">torch.utils.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../jit_utils.html">torch.utils.jit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dlpack.html">torch.utils.dlpack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mobile_optimizer.html">torch.utils.mobile_optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../model_zoo.html">torch.utils.model_zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tensorboard.html">torch.utils.tensorboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../type_info.html">Type Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../named_tensor.html">Named Tensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../name_inference.html">Named Tensors operator coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../config_mod.html">torch.__config__</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../logging.html">torch._logging</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/audio/stable">torchaudio</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/data">TorchData</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/torchrec">TorchRec</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/serve">TorchServe</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/text/stable">torchtext</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/vision/stable">torchvision</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/xla/">PyTorch on XLA Devices</a></li>
</ul>

            
          

        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="../../index.html">Module code</a> &gt;</li>
        
          <li><a href="../../torch.html">torch</a> &gt;</li>
        
      <li>torch._logging._internal</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        

          <!-- Google Tag Manager (noscript) -->
          <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8XT4PS"
          height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
          <!-- End Google Tag Manager (noscript) -->
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <h1>Source code for torch._logging._internal</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="nb">__import__</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span> <span class="nn">weakref</span> <span class="kn">import</span> <span class="n">WeakSet</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">DEFAULT_LOG_LEVEL</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARN</span>
<span class="n">DEFAULT_FORMAT</span> <span class="o">=</span> <span class="s2">&quot;[</span><span class="si">%(asctime)s</span><span class="s2">] </span><span class="si">%(name)s</span><span class="s2">: [</span><span class="si">%(levelname)s</span><span class="s2">] </span><span class="si">%(message)s</span><span class="s2">&quot;</span>
<span class="n">LOG_ENV_VAR</span> <span class="o">=</span> <span class="s2">&quot;TORCH_LOGS&quot;</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">LogRegistry</span><span class="p">:</span>
    <span class="c1"># shorthand name to log qualified name</span>
    <span class="c1"># Note: this only contains loggers registered</span>
    <span class="c1"># from register_log</span>
    <span class="c1"># e.g. &quot;dynamo&quot; -&gt; &quot;torch._dynamo&quot;</span>
    <span class="n">log_alias_to_log_qname</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="c1"># artifact logger qualified names,</span>
    <span class="c1"># this is populated lazily, as calls to getArtifactLogger</span>
    <span class="c1"># currently formatted as &lt;module&gt;.__&lt;artifact_name&gt;</span>
    <span class="c1"># e.g. &quot;torch._dynamo.convert_frame.__guards&quot;</span>
    <span class="n">artifact_log_qnames</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">set</span><span class="p">)</span>

    <span class="c1"># child logs of registered logs if specified via open</span>
    <span class="c1"># registration by the user (ie placing &quot;torch._dynamo.output_graph&quot; in the env var)</span>
    <span class="c1"># these need to be tracked so their levels can be reset properly</span>
    <span class="c1"># e.g. &quot;torch._dynamo.output_graph&quot;</span>
    <span class="n">child_log_qnames</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">set</span><span class="p">)</span>

    <span class="c1"># artifact names, populated by register_artifact</span>
    <span class="c1"># e.g. &quot;guards&quot;</span>
    <span class="n">artifact_names</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">set</span><span class="p">)</span>

    <span class="c1"># artifacts which are not displayed unless explicitly named in the</span>
    <span class="c1"># settings. Ex. output_code is NOT displayed even if the inductor</span>
    <span class="c1"># log level is set to DEBUG. It must be explicitly named in the settings</span>
    <span class="n">off_by_default_artifact_names</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">set</span><span class="p">)</span>

    <span class="c1"># logging format string for artifacts</span>
    <span class="n">artifact_log_formatters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_artifact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">artifact_names</span>

    <span class="k">def</span> <span class="nf">is_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alias</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">alias</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_alias_to_log_qname</span>

    <span class="c1"># register a log with an alias</span>
    <span class="k">def</span> <span class="nf">register_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alias</span><span class="p">,</span> <span class="n">log_qname</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_alias_to_log_qname</span><span class="p">[</span><span class="n">alias</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_qname</span>

    <span class="c1"># register an artifact name</span>
    <span class="k">def</span> <span class="nf">register_artifact_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">off_by_default</span><span class="p">,</span> <span class="n">log_format</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">artifact_names</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># if off by default, don&#39;t enable it</span>
        <span class="c1"># when log_name&#39;s log_level is set to DEBUG</span>
        <span class="k">if</span> <span class="n">off_by_default</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">off_by_default_artifact_names</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">log_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">artifact_log_formatters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="n">log_format</span><span class="p">)</span>

    <span class="c1"># register the qualified name of an artifact log</span>
    <span class="c1"># this is needed to know which logs need to be reset</span>
    <span class="c1"># whenever the log_state is changed</span>
    <span class="k">def</span> <span class="nf">register_artifact_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artifact_log_qname</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">artifact_log_qnames</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">artifact_log_qname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_child_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_qname</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">child_log_qnames</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">log_qname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_log_qnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_alias_to_log_qname</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">get_artifact_log_qnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">artifact_log_qnames</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_child_log_qnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">child_log_qnames</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_off_by_default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artifact_qname</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">artifact_qname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">off_by_default_artifact_names</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">LogState</span><span class="p">:</span>
    <span class="c1"># qualified log names -&gt; currently set log level</span>
    <span class="n">log_qname_to_level</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="c1"># the set of currently enabled artifacts</span>
    <span class="n">artifact_names</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">set</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">enable_artifact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artifact_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">artifact_names</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">artifact_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_artifact_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">artifact_names</span>

    <span class="k">def</span> <span class="nf">enable_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_qname</span><span class="p">,</span> <span class="n">log_level</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_qname_to_level</span><span class="p">[</span><span class="n">log_qname</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_level</span>

    <span class="k">def</span> <span class="nf">get_log_level_pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_qname_to_level</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_qname_to_level</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">artifact_names</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>


<span class="n">log_registry</span> <span class="o">=</span> <span class="n">LogRegistry</span><span class="p">()</span>
<span class="n">log_state</span> <span class="o">=</span> <span class="n">LogState</span><span class="p">()</span>


<div class="viewcode-block" id="set_logs"><a class="viewcode-back" href="../../../generated/torch._logging.set_logs.html#torch._logging.set_logs">[docs]</a><span class="k">def</span> <span class="nf">set_logs</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="nb">all</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dynamo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">aot</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dynamic</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inductor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">distributed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bytecode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">aot_graphs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">aot_joint_graph</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">ddp_graphs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">graph</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">graph_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">graph_breaks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">guards</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">recompiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">output_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">schedule</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">perf_hints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">modules</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the log level for individual components and toggles individual log</span>
<span class="sd">    artifact types.</span>

<span class="sd">    .. warning:: This feature is a prototype and may have compatibility</span>
<span class="sd">        breaking changes in the future.</span>

<span class="sd">    .. note:: The ``TORCH_LOGS`` environment variable has complete precedence</span>
<span class="sd">        over this function, so if it was set, this function does nothing.</span>

<span class="sd">    A component is a set of related features in PyTorch. All of the log</span>
<span class="sd">    messages emitted from a given component have their own log levels. If the</span>
<span class="sd">    log level of a particular message has priority greater than or equal to its</span>
<span class="sd">    component&#39;s log level setting, it is emitted. Otherwise, it is supressed.</span>
<span class="sd">    This allows you to, for instance, silence large groups of log messages that</span>
<span class="sd">    are not relevant to you and increase verbosity of logs for components that</span>
<span class="sd">    are relevant. The expected log level values, ordered from highest to lowest</span>
<span class="sd">    priority, are:</span>

<span class="sd">        * ``logging.CRITICAL``</span>
<span class="sd">        * ``logging.ERROR``</span>
<span class="sd">        * ``logging.WARNING``</span>
<span class="sd">        * ``logging.INFO``</span>
<span class="sd">        * ``logging.DEBUG``</span>
<span class="sd">        * ``logging.NOTSET``</span>

<span class="sd">    See documentation for the Python ``logging`` module for more information on</span>
<span class="sd">    log levels: `&lt;https://docs.python.org/3/library/logging.html#logging-levels&gt;`_</span>

<span class="sd">    An artifact is a particular type of log message. Each artifact is assigned</span>
<span class="sd">    to a parent component. A component can emit many different kinds of</span>
<span class="sd">    artifacts. In general, an artifact is emitted if either its corresponding</span>
<span class="sd">    setting in the argument list below is turned on or if its parent component</span>
<span class="sd">    is set to a log level less than or equal to the log level of the artifact.</span>

<span class="sd">    Keyword args:</span>
<span class="sd">        all (:class:`Optional[int]`):</span>
<span class="sd">            The default log level for all components. Default: ``logging.WARN``</span>

<span class="sd">        dynamo (:class:`Optional[int]`):</span>
<span class="sd">            The log level for the TorchDynamo component. Default: ``logging.WARN``</span>

<span class="sd">        aot (:class:`Optional[int]`):</span>
<span class="sd">            The log level for the AOTAutograd component. Default: ``logging.WARN``</span>

<span class="sd">        inductor (:class:`Optional[int]`):</span>
<span class="sd">            The log level for the TorchInductor component. Default: ``logging.WARN``</span>

<span class="sd">        dynamic (:class:`Optional[int]`):</span>
<span class="sd">            The log level for dynamic shapes. Default: ``logging.WARN``</span>

<span class="sd">        distributed (:class:`Optional[int]`):</span>
<span class="sd">            Whether to log communication operations and other debug info from pytorch distributed components.</span>
<span class="sd">            Default: ``logging.WARN``</span>

<span class="sd">        bytecode (:class:`bool`):</span>
<span class="sd">            Whether to emit the original and generated bytecode from TorchDynamo.</span>
<span class="sd">            Default: ``False``</span>

<span class="sd">        aot_graphs (:class:`bool`):</span>
<span class="sd">            Whether to emit the graphs generated by AOTAutograd. Default: ``False``</span>

<span class="sd">        aot_joint_graph (:class:`bool`):</span>
<span class="sd">            Whether to emit the joint forward-backward graph generated by AOTAutograd. Default: ``False``</span>

<span class="sd">        ddp_graphs (:class:`bool`):</span>
<span class="sd">            Whether to emit graphs generated by DDPOptimizer. Default: ``False``</span>

<span class="sd">        graph (:class:`bool`):</span>
<span class="sd">            Whether to emit the graph captured by TorchDynamo in tabular format.</span>
<span class="sd">            Default: ``False``</span>

<span class="sd">        graph_code (:class:`bool`):</span>
<span class="sd">            Whether to emit the python source of the graph captured by TorchDynamo.</span>
<span class="sd">            Default: ``False``</span>

<span class="sd">        graph_breaks (:class:`bool`):</span>
<span class="sd">            Whether to emit the graph breaks encountered by TorchDynamo.</span>
<span class="sd">            Default: ``False``</span>

<span class="sd">        guards (:class:`bool`):</span>
<span class="sd">            Whether to emit the guards generated by TorchDynamo for each compiled</span>
<span class="sd">            function. Default: ``False``</span>

<span class="sd">        recompiles (:class:`bool`):</span>
<span class="sd">            Whether to emit a guard failure reason and message every time</span>
<span class="sd">            TorchDynamo recompiles a function. Default: ``False``</span>

<span class="sd">        output_code (:class:`bool`):</span>
<span class="sd">            Whether to emit the TorchInductor output code. Default: ``False``</span>

<span class="sd">        schedule (:class:`bool`):</span>
<span class="sd">            Whether to emit the TorchInductor schedule. Default: ``False``</span>

<span class="sd">        perf_hints (:class:`bool`):</span>
<span class="sd">            Whether to emit the TorchInductor perf hints. Default: ``False``</span>

<span class="sd">        modules (dict):</span>
<span class="sd">            This argument provides an alternate way to specify the above log</span>
<span class="sd">            component and artifact settings, in the format of a keyword args</span>
<span class="sd">            dictionary given as a single argument. There are two cases</span>
<span class="sd">            where this is useful (1) if a new log component or artifact has</span>
<span class="sd">            been registered but a keyword argument for it has not been added</span>
<span class="sd">            to this function and (2) if the log level for an unregistered module</span>
<span class="sd">            needs to be set. This can be done by providing the fully-qualified module</span>
<span class="sd">            name as the key, with the log level as the value. Default: ``None``</span>


<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; # xdoctest: +SKIP</span>
<span class="sd">        &gt;&gt;&gt; import logging</span>

<span class="sd">        # The following changes the &quot;dynamo&quot; component to emit DEBUG-level</span>
<span class="sd">        # logs, and to emit &quot;graph_code&quot; artifacts.</span>

<span class="sd">        &gt;&gt;&gt; torch._logging.set_logs(dynamo=logging.DEBUG, graph_code=True)</span>

<span class="sd">        # The following enables the logs for a different module</span>

<span class="sd">        &gt;&gt;&gt; torch._logging.set_logs(modules={&quot;unregistered.module.name&quot;: logging.DEBUG})</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ignore if env var is set</span>
    <span class="k">if</span> <span class="n">LOG_ENV_VAR</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Using TORCH_LOGS environment variable for log settings, ignoring call to set_logs&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="n">log_state</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">modules</span> <span class="o">=</span> <span class="n">modules</span> <span class="ow">or</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">_set_logs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">default_level</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">default_level</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">default_level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">logging</span><span class="o">.</span><span class="n">_levelToName</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unrecognized log level for kwarg all: </span><span class="si">{</span><span class="n">default_level</span><span class="si">}</span><span class="s2">, valid level values &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;are: </span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">logging</span><span class="o">.</span><span class="n">_levelToName</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="c1"># add any missing aliases to kwargs</span>
            <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">log_alias_to_log_qname</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">alias</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="n">alias</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_level</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">default_level</span> <span class="o">=</span> <span class="n">DEFAULT_LOG_LEVEL</span>

        <span class="k">for</span> <span class="n">alias</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">modules</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>  <span class="c1"># type: ignore[union-attr]</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">default_level</span>

            <span class="k">if</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">is_artifact</span><span class="p">(</span><span class="n">alias</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
                    <span class="n">log_state</span><span class="o">.</span><span class="n">enable_artifact</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">is_log</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span> <span class="ow">or</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">child_log_qnames</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">logging</span><span class="o">.</span><span class="n">_levelToName</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Unrecognized log level for log </span><span class="si">{</span><span class="n">alias</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">, valid level values &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;are: </span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">logging</span><span class="o">.</span><span class="n">_levelToName</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

                <span class="n">log_state</span><span class="o">.</span><span class="n">enable_log</span><span class="p">(</span>
                    <span class="n">log_registry</span><span class="o">.</span><span class="n">log_alias_to_log_qname</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="n">alias</span><span class="p">),</span> <span class="n">val</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">alias</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unrecognized log or artifact name passed to set_logs: </span><span class="si">{</span><span class="n">alias</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="n">_init_logs</span><span class="p">()</span>

    <span class="n">_set_logs</span><span class="p">(</span>
        <span class="nb">all</span><span class="o">=</span><span class="nb">all</span><span class="p">,</span>
        <span class="n">dynamo</span><span class="o">=</span><span class="n">dynamo</span><span class="p">,</span>
        <span class="n">aot</span><span class="o">=</span><span class="n">aot</span><span class="p">,</span>
        <span class="n">inductor</span><span class="o">=</span><span class="n">inductor</span><span class="p">,</span>
        <span class="n">dynamic</span><span class="o">=</span><span class="n">dynamic</span><span class="p">,</span>
        <span class="n">bytecode</span><span class="o">=</span><span class="n">bytecode</span><span class="p">,</span>
        <span class="n">aot_graphs</span><span class="o">=</span><span class="n">aot_graphs</span><span class="p">,</span>
        <span class="n">aot_joint_graph</span><span class="o">=</span><span class="n">aot_joint_graph</span><span class="p">,</span>
        <span class="n">ddp_graphs</span><span class="o">=</span><span class="n">ddp_graphs</span><span class="p">,</span>
        <span class="n">distributed</span><span class="o">=</span><span class="n">distributed</span><span class="p">,</span>
        <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span>
        <span class="n">graph_code</span><span class="o">=</span><span class="n">graph_code</span><span class="p">,</span>
        <span class="n">graph_breaks</span><span class="o">=</span><span class="n">graph_breaks</span><span class="p">,</span>
        <span class="n">guards</span><span class="o">=</span><span class="n">guards</span><span class="p">,</span>
        <span class="n">recompiles</span><span class="o">=</span><span class="n">recompiles</span><span class="p">,</span>
        <span class="n">output_code</span><span class="o">=</span><span class="n">output_code</span><span class="p">,</span>
        <span class="n">schedule</span><span class="o">=</span><span class="n">schedule</span><span class="p">,</span>
        <span class="n">perf_hints</span><span class="o">=</span><span class="n">perf_hints</span><span class="p">,</span>
    <span class="p">)</span></div>


<span class="k">def</span> <span class="nf">get_loggers</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns: a list of all registered loggers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">qname</span><span class="p">)</span> <span class="k">for</span> <span class="n">qname</span> <span class="ow">in</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">get_log_qnames</span><span class="p">()]</span>


<span class="k">def</span> <span class="nf">register_log</span><span class="p">(</span><span class="n">setting_name</span><span class="p">,</span> <span class="n">log_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enables a log to be controlled by the env var and user API with the setting_name</span>
<span class="sd">    Args:</span>
<span class="sd">        setting_name:  the shorthand name used in the env var and user API</span>
<span class="sd">        log_name:  the log name that the setting_name is associated with</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">log_registry</span><span class="o">.</span><span class="n">register_log</span><span class="p">(</span><span class="n">setting_name</span><span class="p">,</span> <span class="n">log_name</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">register_artifact</span><span class="p">(</span><span class="n">setting_name</span><span class="p">,</span> <span class="n">off_by_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enables an artifact to be controlled by the env var and user API with name</span>
<span class="sd">    Args:</span>
<span class="sd">        setting_name: the shorthand name used in the env var and user API</span>
<span class="sd">        off_by_default: whether this artifact should be logged when the ancestor loggers</span>
<span class="sd">            are enabled at level DEBUG</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">log_registry</span><span class="o">.</span><span class="n">register_artifact_name</span><span class="p">(</span><span class="n">setting_name</span><span class="p">,</span> <span class="n">off_by_default</span><span class="p">,</span> <span class="n">log_format</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">getArtifactLogger</span><span class="p">(</span><span class="n">module_qname</span><span class="p">,</span> <span class="n">artifact_name</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">artifact_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">artifact_names</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Artifact name: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">artifact_name</span><span class="p">)</span><span class="si">}</span><span class="s2"> not registered,&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;please call register_artifact(</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">artifact_name</span><span class="p">)</span><span class="si">}</span><span class="s2">) in torch._logging.registrations.&quot;</span>
        <span class="p">)</span>
    <span class="n">qname</span> <span class="o">=</span> <span class="n">module_qname</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;.__</span><span class="si">{</span><span class="n">artifact_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">qname</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">artifact_name</span> <span class="o">=</span> <span class="n">artifact_name</span>  <span class="c1"># type: ignore[attr-defined]</span>
    <span class="n">log_registry</span><span class="o">.</span><span class="n">register_artifact_log</span><span class="p">(</span><span class="n">qname</span><span class="p">)</span>
    <span class="n">configure_artifact_log</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">log</span>


<span class="n">INCR_VERBOSITY_CHAR</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span>
<span class="n">DECR_VERBOSITY_CHAR</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
<span class="n">VERBOSITY_REGEX</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;(&quot;</span>
    <span class="o">+</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">INCR_VERBOSITY_CHAR</span><span class="p">),</span> <span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">DECR_VERBOSITY_CHAR</span><span class="p">)])</span>
    <span class="o">+</span> <span class="s2">&quot;?)&quot;</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">configure_artifact_log</span><span class="p">(</span><span class="n">log</span><span class="p">):</span>
    <span class="c1"># If the artifact is off by default, then it should only be logged when explicitly</span>
    <span class="c1"># enabled; set propagate to False so that this artifact is not propagated</span>
    <span class="c1"># to its ancestor logger</span>
    <span class="k">if</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">is_off_by_default</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">artifact_name</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">propagate</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># enable artifact logging when explicitly enabled</span>
    <span class="k">if</span> <span class="n">log_state</span><span class="o">.</span><span class="n">is_artifact_enabled</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">artifact_name</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">propagate</span> <span class="o">=</span> <span class="kc">True</span>


<span class="c1"># match a comma separated list of loggable names (whitespace allowed after commas)</span>
<span class="k">def</span> <span class="nf">_gen_settings_regex</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;((\+|-)?[\w\.]+,\s*)*(\+|-)?[\w\.]+?&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_validate_settings</span><span class="p">(</span><span class="n">settings</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">_gen_settings_regex</span><span class="p">(),</span> <span class="n">settings</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">_invalid_settings_err_msg</span><span class="p">(</span><span class="n">settings</span><span class="p">):</span>
    <span class="n">entities</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">],</span>
            <span class="n">log_registry</span><span class="o">.</span><span class="n">log_alias_to_log_qname</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
            <span class="n">log_registry</span><span class="o">.</span><span class="n">artifact_names</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Invalid log settings: </span><span class="si">{</span><span class="n">settings</span><span class="si">}</span><span class="s2">, must be a comma separated list of fully qualified module names, &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;registered log names or registered artifact names.</span><span class="se">\n</span><span class="s2">Currently registered names: </span><span class="si">{</span><span class="n">entities</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">msg</span>


<span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">_parse_log_settings</span><span class="p">(</span><span class="n">settings</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">settings</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">_validate_settings</span><span class="p">(</span><span class="n">settings</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">_invalid_settings_err_msg</span><span class="p">(</span><span class="n">settings</span><span class="p">))</span>

    <span class="n">settings</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
    <span class="n">log_names</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_name_level_pair</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="n">clean_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">INCR_VERBOSITY_CHAR</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">clean_name</span> <span class="o">=</span> <span class="n">clean_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">DECR_VERBOSITY_CHAR</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">INCR_VERBOSITY_CHAR</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span>
        <span class="k">elif</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">DECR_VERBOSITY_CHAR</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span>

        <span class="k">return</span> <span class="n">clean_name</span><span class="p">,</span> <span class="n">level</span>

    <span class="n">log_state</span> <span class="o">=</span> <span class="n">LogState</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">log_names</span><span class="p">:</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">get_name_level_pair</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">log_qname</span> <span class="ow">in</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">get_log_qnames</span><span class="p">():</span>
                <span class="n">log_state</span><span class="o">.</span><span class="n">enable_log</span><span class="p">(</span><span class="n">log_qname</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">log_names</span><span class="p">:</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">get_name_level_pair</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">is_log</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">log_qname</span> <span class="o">=</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">log_alias_to_log_qname</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">log_state</span><span class="o">.</span><span class="n">enable_log</span><span class="p">(</span><span class="n">log_qname</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">is_artifact</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">log_state</span><span class="o">.</span><span class="n">enable_artifact</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">_is_valid_module</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_has_registered_parent</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="n">log_registry</span><span class="o">.</span><span class="n">register_log</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log_registry</span><span class="o">.</span><span class="n">register_child_log</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">log_state</span><span class="o">.</span><span class="n">enable_log</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">_invalid_settings_err_msg</span><span class="p">(</span><span class="n">settings</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">log_state</span>


<span class="k">def</span> <span class="nf">_is_valid_module</span><span class="p">(</span><span class="n">qname</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">__import__</span><span class="p">(</span><span class="n">qname</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span> <span class="nf">_update_log_state_from_env</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">log_state</span>
    <span class="n">log_setting</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LOG_ENV_VAR</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">log_setting</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log_state</span> <span class="o">=</span> <span class="n">_parse_log_settings</span><span class="p">(</span><span class="n">log_setting</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_has_registered_parent</span><span class="p">(</span><span class="n">log_qname</span><span class="p">):</span>
    <span class="n">cur_log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">log_qname</span><span class="p">)</span>

    <span class="n">registered_log_qnames</span> <span class="o">=</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">get_log_qnames</span><span class="p">()</span>

    <span class="k">while</span> <span class="n">cur_log</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cur_log</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">registered_log_qnames</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">cur_log</span> <span class="o">=</span> <span class="n">cur_log</span><span class="o">.</span><span class="n">parent</span>

    <span class="k">return</span> <span class="kc">False</span>


<span class="c1"># apply custom formats to artifacts when necessary</span>
<span class="k">class</span> <span class="nc">TorchLogsFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="n">artifact_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="s2">&quot;artifact_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">artifact_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">artifact_formatter</span> <span class="o">=</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">artifact_log_formatters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">artifact_name</span><span class="p">,</span> <span class="kc">None</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">artifact_formatter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">artifact_formatter</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>


<span class="n">DEFAULT_FORMATTER</span> <span class="o">=</span> <span class="n">TorchLogsFormatter</span><span class="p">(</span><span class="n">DEFAULT_FORMAT</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_setup_handlers</span><span class="p">(</span><span class="n">create_handler_fn</span><span class="p">,</span> <span class="n">log</span><span class="p">):</span>
    <span class="n">debug_handler</span> <span class="o">=</span> <span class="n">_track_handler</span><span class="p">(</span><span class="n">create_handler_fn</span><span class="p">())</span>
    <span class="n">debug_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">DEFAULT_FORMATTER</span><span class="p">)</span>
    <span class="n">debug_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">debug_handler</span><span class="p">)</span>


<span class="n">handlers</span> <span class="o">=</span> <span class="n">WeakSet</span><span class="p">()</span>  <span class="c1"># type: ignore[var-annotated]</span>


<span class="c1"># mark handlers that we&#39;ve created</span>
<span class="c1"># so we don&#39;t modify user handlers</span>
<span class="k">def</span> <span class="nf">_track_handler</span><span class="p">(</span><span class="n">handler</span><span class="p">):</span>
    <span class="n">handlers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">handler</span>


<span class="k">def</span> <span class="nf">_is_torch_handler</span><span class="p">(</span><span class="n">handler</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">handlers</span>


<span class="c1"># clears all torch handlers on specified loggers</span>
<span class="k">def</span> <span class="nf">_clear_handlers</span><span class="p">(</span><span class="n">log</span><span class="p">):</span>
    <span class="n">to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="n">handler</span> <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">log</span><span class="o">.</span><span class="n">handlers</span> <span class="k">if</span> <span class="n">_is_torch_handler</span><span class="p">(</span><span class="n">handler</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">to_remove</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">removeHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_reset_logs</span><span class="p">():</span>
    <span class="c1"># reset all registered logs</span>
    <span class="k">for</span> <span class="n">log_qname</span> <span class="ow">in</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">get_log_qnames</span><span class="p">():</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">log_qname</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">propagate</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">_clear_handlers</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>

    <span class="c1"># reset all artifact and child logs</span>
    <span class="k">for</span> <span class="n">artifact_log_qname</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
        <span class="n">log_registry</span><span class="o">.</span><span class="n">get_artifact_log_qnames</span><span class="p">(),</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">get_child_log_qnames</span><span class="p">()</span>
    <span class="p">):</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">artifact_log_qname</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">propagate</span> <span class="o">=</span> <span class="kc">True</span>


<span class="k">def</span> <span class="nf">_get_log_state</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">log_state</span>


<span class="k">def</span> <span class="nf">_set_log_state</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">log_state</span>
    <span class="n">log_state</span> <span class="o">=</span> <span class="n">state</span>


<span class="k">def</span> <span class="nf">_init_logs</span><span class="p">(</span><span class="n">log_file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">_reset_logs</span><span class="p">()</span>
    <span class="n">_update_log_state_from_env</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">log_qname</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">log_state</span><span class="o">.</span><span class="n">get_log_level_pairs</span><span class="p">():</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">log_qname</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>

    <span class="c1"># setup handlers for all registered loggers</span>
    <span class="k">for</span> <span class="n">log_qname</span> <span class="ow">in</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">get_log_qnames</span><span class="p">():</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">log_qname</span><span class="p">)</span>
        <span class="n">_setup_handlers</span><span class="p">(</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">,</span>
            <span class="n">log</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">log_file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_setup_handlers</span><span class="p">(</span>
                <span class="k">lambda</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">log_file_name</span><span class="p">),</span>
                <span class="n">log</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="c1"># configure artifact loggers, note: this must happen last</span>
    <span class="c1"># since the levels of ancestor loggers are taken into account</span>
    <span class="k">for</span> <span class="n">artifact_log_qname</span> <span class="ow">in</span> <span class="n">log_registry</span><span class="o">.</span><span class="n">get_artifact_log_qnames</span><span class="p">():</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">artifact_log_qname</span><span class="p">)</span>
        <span class="n">configure_artifact_log</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>


<span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">warning_once</span><span class="p">(</span><span class="n">logger_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is similar to `logger.warning()`, but will emit the warning with the same message only once</span>
<span class="sd">    Note: The cache is for the function arguments, so 2 different callers using the same arguments will hit the cache.</span>
<span class="sd">    The assumption here is that all warning messages are unique across the code. If they aren&#39;t then need to switch to</span>
<span class="sd">    another type of cache that includes the caller frame information in the hashing function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger_obj</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2023, PyTorch Contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
<script>

var match = window.location.href.match(/\/_[a-zA-Z0-9_]*.html|_dynamo/gi);
var url = window.location.href.lastIndexOf(match[match.length-1]);

if (url)
  {
    var div = '<div class="admonition note"><p class="admonition-title">Note</p><p><i class="fa fa-exclamation-circle" aria-hidden="true">&nbsp</i> This page describes an internal API which is not intended to be used outside of the PyTorch codebase and can be modified or removed without notice.</p></div>'
    document.getElementById("pytorch-article").insertAdjacentHTML('afterBegin', div)
  }
</script>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              
            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
         <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
         <script src="../../../_static/jquery.js"></script>
         <script src="../../../_static/underscore.js"></script>
         <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
         <script src="../../../_static/doctools.js"></script>
         <script src="../../../_static/sphinx_highlight.js"></script>
         <script src="../../../_static/clipboard.min.js"></script>
         <script src="../../../_static/copybutton.js"></script>
     

  

  <script type="text/javascript" src="../../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<script script type="text/javascript">
  var collapsedSections = ['Developer Notes', 'Language Bindings', 'Libraries', 'Community'];
</script>

<img height="1" width="1" style="border-style:none;" alt="" src="https://www.googleadservices.com/pagead/conversion/795629140/?label=txkmCPmdtosBENSssfsC&amp;guid=ON&amp;script=0"/>


  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">Get Started</a></li>
            <li><a href="https://pytorch.org/features">Features</a></li>
            <li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
            <li><a href="https://pytorch.org/blog/">Blog</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/resources">Resources</a></li>
            <li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">Brand Guidelines</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title">Stay up to date</li>
            <li><a href="https://www.facebook.com/pytorch" target="_blank">Facebook</a></li>
            <li><a href="https://twitter.com/pytorch" target="_blank">Twitter</a></li>
            <li><a href="https://www.youtube.com/pytorch" target="_blank">YouTube</a></li>
            <li><a href="https://www.linkedin.com/company/pytorch" target="_blank">LinkedIn</a></li>
          </ul>  
          </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title">PyTorch Podcasts</li>
            <li><a href="https://open.spotify.com/show/6UzHKeiy368jKfQMKKvJY5" target="_blank">Spotify</a></li>
            <li><a href="https://podcasts.apple.com/us/podcast/pytorch-developer-podcast/id1566080008" target="_blank">Apple</a></li>
            <li><a href="https://www.google.com/podcasts?feed=aHR0cHM6Ly9mZWVkcy5zaW1wbGVjYXN0LmNvbS9PQjVGa0lsOA%3D%3D" target="_blank">Google</a></li>
            <li><a href="https://music.amazon.com/podcasts/7a4e6f0e-26c2-49e9-a478-41bd244197d0/PyTorch-Developer-Podcast?" target="_blank">Amazon</a></li>
          </ul>
         </div>
        </div>
        
        <div class="privacy-policy">
          <ul>
            <li class="privacy-policy-links"><a href="https://www.linuxfoundation.org/terms/" target="_blank">Terms</a></li>
            <li class="privacy-policy-links">|</li>
            <li class="privacy-policy-links"><a href="https://www.linuxfoundation.org/privacy-policy/" target="_blank">Privacy</a></li>
          </ul>
        </div>
        <div class="copyright">
        <p>Â© Copyright The Linux Foundation. The PyTorch Foundation is a project of The Linux Foundation.
          For web site terms of use, trademark policy and other policies applicable to The PyTorch Foundation please see
          <a href="www.linuxfoundation.org/policies/">www.linuxfoundation.org/policies/</a>. The PyTorch Foundation supports the PyTorch open source
          project, which has been established as PyTorch Project a Series of LF Projects, LLC. For policies applicable to the PyTorch Project a Series of LF Projects, LLC,
          please see <a href="www.lfprojects.org/policies/">www.lfprojects.org/policies/</a>.</p>
      </div>
     </div>

  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebookâ€™s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../../../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>
            
          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="resources-mobile-menu-title" class="active">
            Docs
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/docs/stable/index.html">PyTorch</a>
            </li>

            <li>
              <a href="https://pytorch.org/audio/stable/index.html">torchaudio</a>
            </li>

            <li>
              <a href="https://pytorch.org/text/stable/index.html">torchtext</a>
            </li>

            <li>
              <a href="https://pytorch.org/vision/stable/index.html">torchvision</a>
            </li>

            <li>
              <a href="https://pytorch.org/torcharrow">torcharrow</a>
            </li>

            <li>
              <a href="https://pytorch.org/data">TorchData</a>
            </li>

            <li>
              <a href="https://pytorch.org/torchrec">TorchRec</a>
            </li>

            <li>
              <a href="https://pytorch.org/serve/">TorchServe</a>
            </li>

            <li>
              <a href="https://pytorch.org/torchx/">TorchX</a>
            </li>

            <li>
              <a href="https://pytorch.org/xla">PyTorch on XLA Devices</a>
            </li>
          </ul>

          <li class="resources-mobile-menu-title">
            Resources
          </li>
            
           <ul class="resources-mobile-menu-items">

            <li>
              <a href="https://pytorch.org/features">About</a>
            </li>

            <li>
              <a href="https://pytorch.org/foundation">PyTorch Foundation</a>
            </li>

            <li>
              <a href="https://pytorch.org/#community-module">Community</a>
            </li>

            <li>
              <a href="https://pytorch.org/community-stories">Community Stories</a>
            </li>

            <li>
              <a href="https://pytorch.org/resources">Developer Resources</a>
            </li>

            <li>
              <a href="https://pytorch.org/events">Events</a>
            </li>

            <li>
              <a href="https://discuss.pytorch.org/">Forums</a>
            </li>

            <li>
              <a href="https://pytorch.org/hub">Models (Beta)</a>
            </li>
          </ul>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>