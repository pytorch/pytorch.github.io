


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Distributed communication package (deprecated) - torch.distributed.deprecated &mdash; PyTorch master documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://pytorch.org/docs/stable/distributed_deprecated.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/katex-math.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Legacy package - torch.legacy" href="legacy.html" />
    <link rel="prev" title="torch.onnx" href="onnx.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/features">Features</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="active">
            <a href="https://pytorch.org/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://pytorch.org/resources">Resources</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  master (1.0.0 )
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          

            
            
              
            
            
              <p class="caption"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notes/autograd.html">Autograd mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/broadcasting.html">Broadcasting semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/cuda.html">CUDA semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/extending.html">Extending PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/multiprocessing.html">Multiprocessing best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/randomness.html">Reproducibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/serialization.html">Serialization semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/windows.html">Windows FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="torch.html">torch</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensors.html">torch.Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensor_attributes.html">Tensor Attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="type_info.html">Type Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse.html">torch.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="cuda.html">torch.cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="storage.html">torch.Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn.html">torch.nn</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn.html#torch-nn-functional">torch.nn.functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn.html#torch-nn-init">torch.nn.init</a></li>
<li class="toctree-l1"><a class="reference internal" href="optim.html">torch.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="autograd.html">torch.autograd</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributed.html">torch.distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributions.html">torch.distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="jit.html">torch.jit</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiprocessing.html">torch.multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="bottleneck.html">torch.utils.bottleneck</a></li>
<li class="toctree-l1"><a class="reference internal" href="checkpoint.html">torch.utils.checkpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="cpp_extension.html">torch.utils.cpp_extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">torch.utils.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="dlpack.html">torch.utils.dlpack</a></li>
<li class="toctree-l1"><a class="reference internal" href="ffi.html">torch.utils.ffi</a></li>
<li class="toctree-l1"><a class="reference internal" href="hub.html">torch.hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_zoo.html">torch.utils.model_zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="onnx.html">torch.onnx</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">torch.distributed.deprecated</a></li>
<li class="toctree-l1"><a class="reference internal" href="legacy.html">torch.legacy</a></li>
</ul>
<p class="caption"><span class="caption-text">torchvision Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="torchvision/index.html">torchvision</a></li>
</ul>

            
          

        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Distributed communication package (deprecated) - torch.distributed.deprecated</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/distributed_deprecated.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="distributed-communication-package-deprecated-torch-distributed-deprecated">
<h1>Distributed communication package (deprecated) - torch.distributed.deprecated<a class="headerlink" href="#distributed-communication-package-deprecated-torch-distributed-deprecated" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">torch.distributed.deprecated is the older version of torch.distributed and
currently deprecated. It will be removed soon. Please use and refer the doc
for torch.distributed, which is the latest distributed communication
package for PyTorch</p>
</div>
<span class="target" id="module-torch.distributed.deprecated"></span><p>torch.distributed.deprecated provides an MPI-like interface for exchanging tensor
data across multi-machine networks. It supports a few different backends
and initialization methods.</p>
<p>Currently torch.distributed.deprecated supports four backends, each with
different capabilities. The table below shows which functions are available
for use with CPU / CUDA tensors.
MPI supports cuda only if the implementation used to build PyTorch supports it.</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Backend</th>
<th class="head" colspan="2"><code class="docutils literal notranslate"><span class="pre">tcp</span></code></th>
<th class="head" colspan="2"><code class="docutils literal notranslate"><span class="pre">gloo</span></code></th>
<th class="head" colspan="2"><code class="docutils literal notranslate"><span class="pre">mpi</span></code></th>
<th class="head" colspan="2"><code class="docutils literal notranslate"><span class="pre">nccl</span></code></th>
</tr>
<tr class="row-even"><th class="head">Device</th>
<th class="head">CPU</th>
<th class="head">GPU</th>
<th class="head">CPU</th>
<th class="head">GPU</th>
<th class="head">CPU</th>
<th class="head">GPU</th>
<th class="head">CPU</th>
<th class="head">GPU</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>send</td>
<td>✓</td>
<td>✘</td>
<td>✘</td>
<td>✘</td>
<td>✓</td>
<td>?</td>
<td>✘</td>
<td>✘</td>
</tr>
<tr class="row-even"><td>recv</td>
<td>✓</td>
<td>✘</td>
<td>✘</td>
<td>✘</td>
<td>✓</td>
<td>?</td>
<td>✘</td>
<td>✘</td>
</tr>
<tr class="row-odd"><td>broadcast</td>
<td>✓</td>
<td>✘</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>?</td>
<td>✘</td>
<td>✓</td>
</tr>
<tr class="row-even"><td>all_reduce</td>
<td>✓</td>
<td>✘</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>?</td>
<td>✘</td>
<td>✓</td>
</tr>
<tr class="row-odd"><td>reduce</td>
<td>✓</td>
<td>✘</td>
<td>✘</td>
<td>✘</td>
<td>✓</td>
<td>?</td>
<td>✘</td>
<td>✓</td>
</tr>
<tr class="row-even"><td>all_gather</td>
<td>✓</td>
<td>✘</td>
<td>✘</td>
<td>✘</td>
<td>✓</td>
<td>?</td>
<td>✘</td>
<td>✓</td>
</tr>
<tr class="row-odd"><td>gather</td>
<td>✓</td>
<td>✘</td>
<td>✘</td>
<td>✘</td>
<td>✓</td>
<td>?</td>
<td>✘</td>
<td>✘</td>
</tr>
<tr class="row-even"><td>scatter</td>
<td>✓</td>
<td>✘</td>
<td>✘</td>
<td>✘</td>
<td>✓</td>
<td>?</td>
<td>✘</td>
<td>✘</td>
</tr>
<tr class="row-odd"><td>barrier</td>
<td>✓</td>
<td>✘</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>?</td>
<td>✘</td>
<td>✘</td>
</tr>
</tbody>
</table>
<div class="section" id="basics">
<span id="distributed-deprecated-basics"></span><h2>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">¶</a></h2>
<p>The <cite>torch.distributed.deprecated</cite> package provides PyTorch support and communication primitives
for multiprocess parallelism across several computation nodes running on one or more
machines. The class <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.parallel.deprecated.DistributedDataParallel()</span></code> builds on this
functionality to provide synchronous distributed training as a wrapper around any
PyTorch model. This differs from the kinds of parallelism provided by
<a class="reference internal" href="multiprocessing.html"><span class="doc">Multiprocessing package - torch.multiprocessing</span></a> and <a class="reference internal" href="nn.html#torch.nn.DataParallel" title="torch.nn.DataParallel"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.DataParallel()</span></code></a> in that it supports
multiple network-connected machines and in that the user must explicitly launch a separate
copy of the main training script for each process.</p>
<p>In the single-machine synchronous case, <cite>torch.distributed.deprecated</cite> or the
<code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.parallel.deprecated.DistributedDataParallel()</span></code> wrapper may still have advantages over other
approaches to data-parallelism, including <a class="reference internal" href="nn.html#torch.nn.DataParallel" title="torch.nn.DataParallel"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.DataParallel()</span></code></a>:</p>
<ul class="simple">
<li>Each process maintains its own optimizer and performs a complete optimization step with each
iteration. While this may appear redundant, since the gradients have already been gathered
together and averaged across processes and are thus the same for every process, this means
that no parameter broadcast step is needed, reducing time spent transferring tensors between
nodes.</li>
<li>Each process contains an independent Python interpreter, eliminating the extra interpreter
overhead and “GIL-thrashing” that comes from driving several execution threads, model
replicas, or GPUs from a single Python process. This is especially important for models that
make heavy use of the Python runtime, including models with recurrent layers or many small
components.</li>
</ul>
</div>
<div class="section" id="initialization">
<h2>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h2>
<p>The package needs to be initialized using the <a class="reference internal" href="#torch.distributed.deprecated.init_process_group" title="torch.distributed.deprecated.init_process_group"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.distributed.deprecated.init_process_group()</span></code></a>
function before calling any other methods. This blocks until all processes have
joined.</p>
<dl class="function">
<dt id="torch.distributed.deprecated.init_process_group">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">init_process_group</code><span class="sig-paren">(</span><em>backend</em>, <em>init_method='env://'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#init_process_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.init_process_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the distributed package.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Name of the backend to use. Depending on build-time configuration
valid values include: <code class="docutils literal notranslate"><span class="pre">tcp</span></code>, <code class="docutils literal notranslate"><span class="pre">mpi</span></code>, <code class="docutils literal notranslate"><span class="pre">gloo</span></code> and <code class="docutils literal notranslate"><span class="pre">nccl</span></code>.</li>
<li><strong>init_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>optional</em>) – URL specifying how to initialize the package.</li>
<li><strong>world_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of processes participating in the job.</li>
<li><strong>rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Rank of the current process.</li>
<li><strong>group_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>optional</em>) – Group name. See description of init methods.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>To enable <code class="docutils literal notranslate"><span class="pre">backend</span> <span class="pre">==</span> <span class="pre">mpi</span></code>, PyTorch needs to built from source on a system that
supports MPI. If you want to use Open MPI with CUDA-aware support, please use
Open MPI major version 2 and above.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method initializes CUDA context. Therefore, if multiple processes
run on a single machine but use different GPUs, make sure to use
<a class="reference internal" href="cuda.html#torch.cuda.set_device" title="torch.cuda.set_device"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.cuda.set_device()</span></code></a> before this method to avoid unnecessarily
creating context on the first visible device.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.get_rank">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">get_rank</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#get_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.get_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the rank of current process.</p>
<p>Rank is a unique identifier assigned to each process within a distributed
group. They are always consecutive integers ranging from <code class="docutils literal notranslate"><span class="pre">0</span></code> to
<code class="docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">-</span> <span class="pre">1</span></code> (inclusive).</p>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.get_world_size">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">get_world_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#get_world_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.get_world_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of processes in the distributed group.</p>
</dd></dl>

<hr class="docutils" />
<p>Currently three initialization methods are supported:</p>
<div class="section" id="tcp-initialization">
<h3>TCP initialization<a class="headerlink" href="#tcp-initialization" title="Permalink to this headline">¶</a></h3>
<p>There are two ways to initialize using TCP, both requiring a network address
reachable from all processes and a desired <code class="docutils literal notranslate"><span class="pre">world_size</span></code>. The first way
requires specifying an address that belongs to the rank 0 process. This
initialization method requires that all processes have manually specified ranks.</p>
<p>Alternatively, the address has to be a valid IP multicast address, in which case
ranks can be assigned automatically. Multicast initialization also supports
a <code class="docutils literal notranslate"><span class="pre">group_name</span></code> argument, which allows you to use the same address for multiple
jobs, as long as they use different group names.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch.distributed.deprecated</span> <span class="k">as</span> <span class="nn">dist</span>

<span class="c1"># Use address of one of the machines</span>
<span class="n">dist</span><span class="o">.</span><span class="n">init_process_group</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">init_method</span><span class="o">=</span><span class="s1">&#39;tcp://10.1.1.20:23456&#39;</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">rank</span><span class="p">,</span> <span class="n">world_size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># or a multicast address - rank will be assigned automatically if unspecified</span>
<span class="n">dist</span><span class="o">.</span><span class="n">init_process_group</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">init_method</span><span class="o">=</span><span class="s1">&#39;tcp://[ff15:1e18:5d4c:4cf0:d02d:b659:53ba:b0a7]:23456&#39;</span><span class="p">,</span>
                        <span class="n">world_size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="shared-file-system-initialization">
<h3>Shared file-system initialization<a class="headerlink" href="#shared-file-system-initialization" title="Permalink to this headline">¶</a></h3>
<p>Another initialization method makes use of a file system that is shared and
visible from all machines in a group, along with a desired <code class="docutils literal notranslate"><span class="pre">world_size</span></code>. The URL should start
with <code class="docutils literal notranslate"><span class="pre">file://</span></code> and contain a path to a non-existent file (in an existing
directory) on a shared file system. This initialization method also supports a
<code class="docutils literal notranslate"><span class="pre">group_name</span></code> argument, which allows you to use the same shared file path for
multiple jobs, as long as they use different group names.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This method assumes that the file system supports locking using <code class="docutils literal notranslate"><span class="pre">fcntl</span></code> - most
local systems and NFS support it.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch.distributed.deprecated</span> <span class="k">as</span> <span class="nn">dist</span>

<span class="c1"># Rank will be assigned automatically if unspecified</span>
<span class="n">dist</span><span class="o">.</span><span class="n">init_process_group</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">init_method</span><span class="o">=</span><span class="s1">&#39;file:///mnt/nfs/sharedfile&#39;</span><span class="p">,</span>
                        <span class="n">world_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">group</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="environment-variable-initialization">
<h3>Environment variable initialization<a class="headerlink" href="#environment-variable-initialization" title="Permalink to this headline">¶</a></h3>
<p>This method will read the configuration from environment variables, allowing
one to fully customize how the information is obtained. The variables to be set
are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">MASTER_PORT</span></code> - required; has to be a free port on machine with rank 0</li>
<li><code class="docutils literal notranslate"><span class="pre">MASTER_ADDR</span></code> - required (except for rank 0); address of rank 0 node</li>
<li><code class="docutils literal notranslate"><span class="pre">WORLD_SIZE</span></code> - required; can be set either here, or in a call to init function</li>
<li><code class="docutils literal notranslate"><span class="pre">RANK</span></code> - required; can be set either here, or in a call to init function</li>
</ul>
<p>The machine with rank 0 will be used to set up all connections.</p>
<p>This is the default method, meaning that <code class="docutils literal notranslate"><span class="pre">init_method</span></code> does not have to be specified (or
can be <code class="docutils literal notranslate"><span class="pre">env://</span></code>).</p>
</div>
</div>
<div class="section" id="groups">
<h2>Groups<a class="headerlink" href="#groups" title="Permalink to this headline">¶</a></h2>
<p>By default collectives operate on the default group (also called the world) and
require all processes to enter the distributed function call. However, some workloads can benefit
from more fine-grained communication. This is where distributed groups come
into play. <a class="reference internal" href="#torch.distributed.deprecated.new_group" title="torch.distributed.deprecated.new_group"><code class="xref py py-func docutils literal notranslate"><span class="pre">new_group()</span></code></a> function can be
used to create new groups, with arbitrary subsets of all processes. It returns
an opaque group handle that can be given as a <code class="docutils literal notranslate"><span class="pre">group</span></code> argument to all collectives
(collectives are distributed functions to exchange information in certain well-known programming patterns).</p>
<dl class="function">
<dt id="torch.distributed.deprecated.new_group">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">new_group</code><span class="sig-paren">(</span><em>ranks=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#new_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.new_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new distributed group.</p>
<p>This function requires that all processes in the main group (i.e., all
processes that are part of the distributed job) enter this function, even
if they are not going to be members of the group. Additionally, groups
should be created in the same order in all processes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>]</em>) – List of ranks of group members.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A handle of distributed group that can be given to collective calls.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="point-to-point-communication">
<h2>Point-to-point communication<a class="headerlink" href="#point-to-point-communication" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="torch.distributed.deprecated.send">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">send</code><span class="sig-paren">(</span><em>tensor</em>, <em>dst</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#send"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a tensor synchronously.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tensor</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – Tensor to send.</li>
<li><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Destination rank.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.recv">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">recv</code><span class="sig-paren">(</span><em>tensor</em>, <em>src=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#recv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.recv" title="Permalink to this definition">¶</a></dt>
<dd><p>Receives a tensor synchronously.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tensor</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – Tensor to fill with received data.</li>
<li><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Source rank. Will receive from any
process if unspecified.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Sender rank.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p><a class="reference internal" href="#torch.distributed.deprecated.isend" title="torch.distributed.deprecated.isend"><code class="xref py py-func docutils literal notranslate"><span class="pre">isend()</span></code></a> and <a class="reference internal" href="#torch.distributed.deprecated.irecv" title="torch.distributed.deprecated.irecv"><code class="xref py py-func docutils literal notranslate"><span class="pre">irecv()</span></code></a>
return distributed request objects when used. In general, the type of this object is unspecified
as they should never be created manually, but they are guaranteed to support two methods:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">is_completed()</span></code> - returns True if the operation has finished</li>
<li><code class="docutils literal notranslate"><span class="pre">wait()</span></code> - will block the process until the operation is finished.
<code class="docutils literal notranslate"><span class="pre">is_completed()</span></code> is guaranteed to return True once it returns.</li>
</ul>
<p>When using the MPI backend, <a class="reference internal" href="#torch.distributed.deprecated.isend" title="torch.distributed.deprecated.isend"><code class="xref py py-func docutils literal notranslate"><span class="pre">isend()</span></code></a> and <a class="reference internal" href="#torch.distributed.deprecated.irecv" title="torch.distributed.deprecated.irecv"><code class="xref py py-func docutils literal notranslate"><span class="pre">irecv()</span></code></a>
support non-overtaking, which has some guarantees on supporting message order. For more detail, see
<a class="reference external" href="http://mpi-forum.org/docs/mpi-2.2/mpi22-report/node54.htm#Node54">http://mpi-forum.org/docs/mpi-2.2/mpi22-report/node54.htm#Node54</a></p>
<dl class="function">
<dt id="torch.distributed.deprecated.isend">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">isend</code><span class="sig-paren">(</span><em>tensor</em>, <em>dst</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#isend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.isend" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a tensor asynchronously.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tensor</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – Tensor to send.</li>
<li><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Destination rank.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A distributed request object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.irecv">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">irecv</code><span class="sig-paren">(</span><em>tensor</em>, <em>src</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#irecv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.irecv" title="Permalink to this definition">¶</a></dt>
<dd><p>Receives a tensor asynchronously.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tensor</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – Tensor to fill with received data.</li>
<li><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Source rank.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A distributed request object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="collective-functions">
<h2>Collective functions<a class="headerlink" href="#collective-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="torch.distributed.deprecated.broadcast">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">broadcast</code><span class="sig-paren">(</span><em>tensor</em>, <em>src</em>, <em>group=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#broadcast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.broadcast" title="Permalink to this definition">¶</a></dt>
<dd><p>Broadcasts the tensor to the whole group.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code> must have the same number of elements in all processes
participating in the collective.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tensor</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – Data to be sent if <code class="xref py py-attr docutils literal notranslate"><span class="pre">src</span></code> is the rank of
current process, and tensor to be used to save received data
otherwise.</li>
<li><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Source rank.</li>
<li><strong>group</strong> (<em>optional</em>) – Group of the collective.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.all_reduce">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">all_reduce</code><span class="sig-paren">(</span><em>tensor</em>, <em>op=&lt;object object&gt;</em>, <em>group=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#all_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.all_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces the tensor data across all machines in such a way that all get
the final result.</p>
<p>After the call <code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code> will be bitwise identical in all processes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tensor</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – Input and output of the collective. The function
operates in-place.</li>
<li><strong>op</strong> (<em>optional</em>) – One of the values from <code class="docutils literal notranslate"><span class="pre">torch.distributed.deprecated.reduce_op</span></code>
enum.  Specifies an operation used for element-wise reductions.</li>
<li><strong>group</strong> (<em>optional</em>) – Group of the collective.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.reduce">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">reduce</code><span class="sig-paren">(</span><em>tensor</em>, <em>dst</em>, <em>op=&lt;object object&gt;</em>, <em>group=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces the tensor data across all machines.</p>
<p>Only the process with rank <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst</span></code> is going to receive the final result.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tensor</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – Input and output of the collective. The function
operates in-place.</li>
<li><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Destination rank</li>
<li><strong>op</strong> (<em>optional</em>) – One of the values from <code class="docutils literal notranslate"><span class="pre">torch.distributed.deprecated.reduce_op</span></code>
enum.  Specifies an operation used for element-wise reductions.</li>
<li><strong>group</strong> (<em>optional</em>) – Group of the collective.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.all_gather">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">all_gather</code><span class="sig-paren">(</span><em>tensor_list</em>, <em>tensor</em>, <em>group=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#all_gather"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.all_gather" title="Permalink to this definition">¶</a></dt>
<dd><p>Gathers tensors from the whole group in a list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tensor_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>[</em><a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a><em>]</em>) – Output list. It should contain
correctly-sized tensors to be used for output of the collective.</li>
<li><strong>tensor</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – Tensor to be broadcast from current process.</li>
<li><strong>group</strong> (<em>optional</em>) – Group of the collective.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.gather">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">gather</code><span class="sig-paren">(</span><em>tensor</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#gather"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.gather" title="Permalink to this definition">¶</a></dt>
<dd><p>Gathers a list of tensors in a single process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tensor</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – Input tensor.</li>
<li><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Destination rank. Required in all processes except the one that
is receiveing the data.</li>
<li><strong>gather_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>[</em><a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a><em>]</em>) – List of appropriately-sized tensors to
use for received data. Required only in the receiving process.</li>
<li><strong>group</strong> (<em>optional</em>) – Group of the collective.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.scatter">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">scatter</code><span class="sig-paren">(</span><em>tensor</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#scatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Scatters a list of tensors to all processes in a group.</p>
<p>Each process will receive exactly one tensor and store its data in the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code> argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tensor</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – Output tensor.</li>
<li><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Source rank. Required in all processes except the one that
is sending the data.</li>
<li><strong>scatter_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>[</em><a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a><em>]</em>) – List of tensors to scatter. Required only
in the process that is sending the data.</li>
<li><strong>group</strong> (<em>optional</em>) – Group of the collective.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.barrier">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">barrier</code><span class="sig-paren">(</span><em>group=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#barrier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.barrier" title="Permalink to this definition">¶</a></dt>
<dd><p>Synchronizes all processes.</p>
<p>This collective blocks processes until the whole group enters this function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>group</strong> (<em>optional</em>) – Group of the collective.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="multi-gpu-collective-functions">
<h2>Multi-GPU collective functions<a class="headerlink" href="#multi-gpu-collective-functions" title="Permalink to this headline">¶</a></h2>
<p>If you have more than one GPU on each node, when using the NCCL backend,
<a class="reference internal" href="#torch.distributed.deprecated.broadcast_multigpu" title="torch.distributed.deprecated.broadcast_multigpu"><code class="xref py py-func docutils literal notranslate"><span class="pre">broadcast_multigpu()</span></code></a>
<a class="reference internal" href="#torch.distributed.deprecated.all_reduce_multigpu" title="torch.distributed.deprecated.all_reduce_multigpu"><code class="xref py py-func docutils literal notranslate"><span class="pre">all_reduce_multigpu()</span></code></a>
<a class="reference internal" href="#torch.distributed.deprecated.reduce_multigpu" title="torch.distributed.deprecated.reduce_multigpu"><code class="xref py py-func docutils literal notranslate"><span class="pre">reduce_multigpu()</span></code></a> and
<a class="reference internal" href="#torch.distributed.deprecated.all_gather_multigpu" title="torch.distributed.deprecated.all_gather_multigpu"><code class="xref py py-func docutils literal notranslate"><span class="pre">all_gather_multigpu()</span></code></a> support distributed collective
operations among multiple GPUs within each node. These functions can potentially
improve the overall distributed training performance and be easily used by
passing a list of tensors. Each Tensor in the passed tensor list needs
to be on a separate GPU device of the host where the function is called. Note
that the length of the tensor list needs to be identical among all the
distributed processes. Also note that currently the multi-GPU collective
functions are only supported by the NCCL backend.</p>
<p>For example, if the system we use for distributed training has 2 nodes, each
of which has 8 GPUs. On each of the 16 GPUs, there is a tensor that we would
like to all-reduce. The following code can serve as a reference:</p>
<p>Code running on Node 0</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.distributed.deprecated</span> <span class="k">as</span> <span class="nn">dist</span>

<span class="n">dist</span><span class="o">.</span><span class="n">init_process_group</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;nccl&quot;</span><span class="p">,</span>
                        <span class="n">init_method</span><span class="o">=</span><span class="s2">&quot;file:///distributed_test&quot;</span><span class="p">,</span>
                        <span class="n">world_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">rank</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tensor_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">dev_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device_count</span><span class="p">()):</span>
    <span class="n">tensor_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">cuda</span><span class="p">(</span><span class="n">dev_idx</span><span class="p">))</span>

<span class="n">dist</span><span class="o">.</span><span class="n">all_reduce_multigpu</span><span class="p">(</span><span class="n">tensor_list</span><span class="p">)</span>
</pre></div>
</div>
<p>Code running on Node 1</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.distributed.deprecated</span> <span class="k">as</span> <span class="nn">dist</span>

<span class="n">dist</span><span class="o">.</span><span class="n">init_process_group</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;nccl&quot;</span><span class="p">,</span>
                        <span class="n">init_method</span><span class="o">=</span><span class="s2">&quot;file:///distributed_test&quot;</span><span class="p">,</span>
                        <span class="n">world_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">rank</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">tensor_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">dev_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device_count</span><span class="p">()):</span>
    <span class="n">tensor_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">cuda</span><span class="p">(</span><span class="n">dev_idx</span><span class="p">))</span>

<span class="n">dist</span><span class="o">.</span><span class="n">all_reduce_multigpu</span><span class="p">(</span><span class="n">tensor_list</span><span class="p">)</span>
</pre></div>
</div>
<p>After the call, all 16 tensors on the two nodes will have the all-reduced value
of 16</p>
<dl class="function">
<dt id="torch.distributed.deprecated.broadcast_multigpu">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">broadcast_multigpu</code><span class="sig-paren">(</span><em>tensor_list</em>, <em>src</em>, <em>group=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#broadcast_multigpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.broadcast_multigpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Broadcasts the tensor to the whole group with multiple GPU tensors
per node.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code> must have the same number of elements in all the GPUs from
all processes participating in the collective. each tensor in the list must
be on a different GPU.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only NCCL backend is currently supported. <code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor_list</span></code> should only
contain GPU tensors.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tensor_list</strong> (<em>List</em><em>[</em><a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a><em>]</em>) – Tensors that participate in the collective
operation. if <code class="docutils literal notranslate"><span class="pre">src</span></code> is the rank, then the first element of
<code class="docutils literal notranslate"><span class="pre">tensor_list</span></code> (<code class="docutils literal notranslate"><span class="pre">tensor_list[0]</span></code>) will be broadcasted to all
other tensors (on different GPUs) in the src process and all tensors
in <code class="docutils literal notranslate"><span class="pre">tensor_list</span></code> of other non-src processes. You also need to make
sure that <code class="docutils literal notranslate"><span class="pre">len(tensor_list)</span></code> is the same for all the distributed
processes calling this function.</li>
<li><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Source rank.</li>
<li><strong>group</strong> (<em>optional</em>) – Group of the collective.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.all_reduce_multigpu">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">all_reduce_multigpu</code><span class="sig-paren">(</span><em>tensor_list</em>, <em>op=&lt;object object&gt;</em>, <em>group=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#all_reduce_multigpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.all_reduce_multigpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces the tensor data across all machines in such a way that all get
the final result. This function reduces a number of tensors on every node,
while each tensor resides on a different GPU.
Therefore, the input tensor in the tensor list needs to be GPU tensors.
Also, each tensor in the tensor list needs to reside on a different GPU.</p>
<p>After the call, all tensors in <code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor_list</span></code> will be bitwise identical
in all processes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only NCCL backend is currently supported. <code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor_list</span></code> should only
contain GPU tensors.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tensor_list</strong> (<em>List</em><em>[</em><a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a><em>]</em>) – List of input and output tensors of
the collective. The function operates in-place and requires that
each tensor to be a GPU tensor on different GPUs.
You also need to make sure that <code class="docutils literal notranslate"><span class="pre">len(tensor_list)</span></code> is the same for
all the distributed processes calling this function.</li>
<li><strong>op</strong> (<em>optional</em>) – One of the values from <code class="docutils literal notranslate"><span class="pre">torch.distributed.deprecated.reduce_op</span></code>
enum.  Specifies an operation used for element-wise reductions.</li>
<li><strong>group</strong> (<em>optional</em>) – Group of the collective.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.reduce_multigpu">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">reduce_multigpu</code><span class="sig-paren">(</span><em>tensor_list</em>, <em>dst</em>, <em>op=&lt;object object&gt;</em>, <em>group=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#reduce_multigpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.reduce_multigpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces the tensor data on multiple GPUs across all machines. Each tensor
in :attr`tensor_list` should reside on a separate GPU.</p>
<p>Only the GPU of <code class="docutils literal notranslate"><span class="pre">tensor_list[0]</span></code> on the process with rank <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst</span></code> is
going to receive the final result.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only NCCL backend is currently supported. <code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor_list</span></code> should only
contain GPU tensors.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tensor_list</strong> (<em>List</em><em>[</em><a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a><em>]</em>) – Input and output GPU tensors of the
collective. The function operates in-place.
You also need to make sure that <code class="docutils literal notranslate"><span class="pre">len(tensor_list)</span></code> is the same for
all the distributed processes calling this function.</li>
<li><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Destination rank</li>
<li><strong>op</strong> (<em>optional</em>) – One of the values from <code class="docutils literal notranslate"><span class="pre">torch.distributed.deprecated.reduce_op</span></code>
enum.  Specifies an operation used for element-wise reductions.</li>
<li><strong>group</strong> (<em>optional</em>) – Group of the collective.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch.distributed.deprecated.all_gather_multigpu">
<code class="descclassname">torch.distributed.deprecated.</code><code class="descname">all_gather_multigpu</code><span class="sig-paren">(</span><em>output_tensor_lists</em>, <em>input_tensor_list</em>, <em>group=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/distributed/deprecated.html#all_gather_multigpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.distributed.deprecated.all_gather_multigpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Gathers tensors from the whole group in a list.
Each tensor in <code class="xref py py-attr docutils literal notranslate"><span class="pre">input_tensor_list</span></code> should reside on a separate GPU.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only NCCL backend is currently supported. <code class="xref py py-attr docutils literal notranslate"><span class="pre">output_tensor_lists</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">input_tensor_list</span></code> should only contain GPU tensors.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>output_tensor_lists</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a><em>]</em><em>]</em>) – Output lists. It should
contain correctly-sized tensors on each GPU to be used for output of
the collective.
e.g. <code class="docutils literal notranslate"><span class="pre">output_tensor_lists[i]</span></code> contains the all_gather
result that resides on the GPU of <code class="docutils literal notranslate"><span class="pre">input_tensor_list[i]</span></code>.
Note that each element of <code class="docutils literal notranslate"><span class="pre">output_tensor_lists[i]</span></code> has the size of
<code class="docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">*</span> <span class="pre">len(input_tensor_list)</span></code>, since the function all
gathers the result from every single GPU in the group. To interpret
each element of <code class="docutils literal notranslate"><span class="pre">output_tensor_list[i]</span></code>, note that
<code class="docutils literal notranslate"><span class="pre">input_tensor_list[j]</span></code> of rank k will be appear in
<code class="docutils literal notranslate"><span class="pre">output_tensor_list[i][rank</span> <span class="pre">*</span> <span class="pre">world_size</span> <span class="pre">+</span> <span class="pre">j]</span></code>
Also note that <code class="docutils literal notranslate"><span class="pre">len(output_tensor_lists)</span></code>, and the size of each
element in <code class="docutils literal notranslate"><span class="pre">output_tensor_lists</span></code> (each element is a list,
therefore <code class="docutils literal notranslate"><span class="pre">len(output_tensor_lists[i])</span></code>) need to be the same
for all the distributed processes calling this function.</li>
<li><strong>input_tensor_list</strong> (<em>List</em><em>[</em><a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a><em>]</em>) – List of tensors (on different GPUs) to
be broadcast from current process.
Note that <code class="docutils literal notranslate"><span class="pre">len(input_tensor_list)</span></code> needs to be the same for
all the distributed processes calling this function.</li>
<li><strong>group</strong> (<em>optional</em>) – Group of the collective.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="launch-utility">
<h2>Launch utility<a class="headerlink" href="#launch-utility" title="Permalink to this headline">¶</a></h2>
<p>The <cite>torch.distributed.deprecated</cite> package also provides a launch utility in
<cite>torch.distributed.deprecated.launch</cite>.</p>
<span class="target" id="module-torch.distributed.launch"></span><p><cite>torch.distributed.launch</cite> is a module that spawns up multiple distributed
training processes on each of the training nodes.</p>
<p>The utility can be used for single-node distributed training, in which one or
more processes per node will be spawned. The utility can be used for either
CPU training or GPU training. If the utility is used for GPU training,
each distributed process will be operating on a single GPU. This can achieve
well-improved single-node training performance. It can also be used in
multi-node distributed training, by spawning up multiple processes on each node
for well-improved multi-node distributed training performance as well.
This will especially be benefitial for systems with multiple Infiniband
interfaces that have direct-GPU support, since all of them can be utilized for
aggregated communication bandwidth.</p>
<p>In both cases of single-node distributed training or multi-node distributed
training, this utility will launch the given number of processes per node
(<code class="docutils literal notranslate"><span class="pre">--nproc_per_node</span></code>). If used for GPU training, this number needs to be less
or euqal to the number of GPUs on the current system (<code class="docutils literal notranslate"><span class="pre">nproc_per_node</span></code>),
and each process will be operating on a single GPU from <em>GPU 0 to
GPU (nproc_per_node - 1)</em>.</p>
<p><strong>How to use this module:</strong></p>
<ol class="arabic simple">
<li>Single-Node multi-process distributed training</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">torch</span><span class="o">.</span><span class="n">distributed</span><span class="o">.</span><span class="n">launch</span> <span class="o">--</span><span class="n">nproc_per_node</span><span class="o">=</span><span class="n">NUM_GPUS_YOU_HAVE</span>
<span class="go">           YOUR_TRAINING_SCRIPT.py (--arg1 --arg2 --arg3 and all other</span>
<span class="go">           arguments of your training script)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Multi-Node multi-process distributed training: (e.g. two nodes)</li>
</ol>
<p>Node 1: <em>(IP: 192.168.1.1, and has a free port: 1234)</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">torch</span><span class="o">.</span><span class="n">distributed</span><span class="o">.</span><span class="n">launch</span> <span class="o">--</span><span class="n">nproc_per_node</span><span class="o">=</span><span class="n">NUM_GPUS_YOU_HAVE</span>
<span class="go">           --nnodes=2 --node_rank=0 --master_addr=&quot;192.168.1.1&quot;</span>
<span class="go">           --master_port=1234 YOUR_TRAINING_SCRIPT.py (--arg1 --arg2 --arg3</span>
<span class="go">           and all other arguments of your training script)</span>
</pre></div>
</div>
<p>Node 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">torch</span><span class="o">.</span><span class="n">distributed</span><span class="o">.</span><span class="n">launch</span> <span class="o">--</span><span class="n">nproc_per_node</span><span class="o">=</span><span class="n">NUM_GPUS_YOU_HAVE</span>
<span class="go">           --nnodes=2 --node_rank=1 --master_addr=&quot;192.168.1.1&quot;</span>
<span class="go">           --master_port=1234 YOUR_TRAINING_SCRIPT.py (--arg1 --arg2 --arg3</span>
<span class="go">           and all other arguments of your training script)</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>To look up what optional arguments this module offers:</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">torch</span><span class="o">.</span><span class="n">distributed</span><span class="o">.</span><span class="n">launch</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p><strong>Important Notices:</strong></p>
<p>1. This utilty and multi-process distributed (single-node or
multi-node) GPU training currently only achieves the best performance using
the NCCL distributed backend. Thus NCCL backend is the recommended backend to
use for GPU training.</p>
<p>2. In your training program, you must parse the command-line argument:
<code class="docutils literal notranslate"><span class="pre">--local_rank=LOCAL_PROCESS_RANK</span></code>, which will be provided by this module.
If your training program uses GPUs, you should ensure that your code only
runs on the GPU device of LOCAL_PROCESS_RANK. This can be done by:</p>
<p>Parsing the local_rank argument</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--local_rank&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</pre></div>
</div>
<p>Set your device to local rank using either</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">set_device</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">local_rank</span><span class="p">)</span>  <span class="c1"># before your code runs</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">local_rank</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="c1"># your code to run</span>
</pre></div>
</div>
<p>3. In your training program, you are supposed to call the following function
at the beginning to start the distributed backend. You need to make sure that
the init_method uses <code class="docutils literal notranslate"><span class="pre">env://</span></code>, which is the only supported <code class="docutils literal notranslate"><span class="pre">init_method</span></code>
by this module.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">distributed</span><span class="o">.</span><span class="n">init_process_group</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s1">&#39;YOUR BACKEND&#39;</span><span class="p">,</span>
                                     <span class="n">init_method</span><span class="o">=</span><span class="s1">&#39;env://&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>4. In your training program, you can either use regular distributed functions
or use <a class="reference internal" href="nn.html#torch.nn.parallel.DistributedDataParallel" title="torch.nn.parallel.DistributedDataParallel"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.parallel.DistributedDataParallel()</span></code></a> module. If your
training program uses GPUs for training and you would like to use
<a class="reference internal" href="nn.html#torch.nn.parallel.DistributedDataParallel" title="torch.nn.parallel.DistributedDataParallel"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.parallel.DistributedDataParallel()</span></code></a> module,
here is how to configure it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">parallel</span><span class="o">.</span><span class="n">DistributedDataParallel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span>
                                                  <span class="n">device_ids</span><span class="o">=</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">local_rank</span><span class="p">],</span>
                                                  <span class="n">output_device</span><span class="o">=</span><span class="n">arg</span><span class="o">.</span><span class="n">local_rank</span><span class="p">)</span>
</pre></div>
</div>
<p>Please ensure that <code class="docutils literal notranslate"><span class="pre">device_ids</span></code> argument is set to be the only GPU device id
that your code will be operating on. This is generally the local rank of the
process. In other words, the <code class="docutils literal notranslate"><span class="pre">device_ids</span></code> needs to be <code class="docutils literal notranslate"><span class="pre">[args.local_rank]</span></code>,
and <code class="docutils literal notranslate"><span class="pre">output_device</span></code> needs to be <code class="docutils literal notranslate"><span class="pre">args.local_rank</span></code> in order to use this
utility</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">local_rank</span></code> is NOT globally unique: it is only unique per process
on a machine.  Thus, don’t use it to decide if you should, e.g.,
write to a networked filesystem.  See
<a class="reference external" href="https://github.com/pytorch/pytorch/issues/12042">https://github.com/pytorch/pytorch/issues/12042</a> for an example of
how things can go wrong if you don’t do this correctly.</p>
</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="legacy.html" class="btn btn-neutral float-right" title="Legacy package - torch.legacy" accesskey="n" rel="next">Next <img src="_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="onnx.html" class="btn btn-neutral" title="torch.onnx" accesskey="p" rel="prev"><img src="_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Torch Contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Distributed communication package (deprecated) - torch.distributed.deprecated</a><ul>
<li><a class="reference internal" href="#basics">Basics</a></li>
<li><a class="reference internal" href="#initialization">Initialization</a><ul>
<li><a class="reference internal" href="#tcp-initialization">TCP initialization</a></li>
<li><a class="reference internal" href="#shared-file-system-initialization">Shared file-system initialization</a></li>
<li><a class="reference internal" href="#environment-variable-initialization">Environment variable initialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#groups">Groups</a></li>
<li><a class="reference internal" href="#point-to-point-communication">Point-to-point communication</a></li>
<li><a class="reference internal" href="#collective-functions">Collective functions</a></li>
<li><a class="reference internal" href="#multi-gpu-collective-functions">Multi-GPU collective functions</a></li>
<li><a class="reference internal" href="#launch-utility">Launch utility</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script type="text/javascript" src="_static/jquery.js"></script>
         <script type="text/javascript" src="_static/underscore.js"></script>
         <script type="text/javascript" src="_static/doctools.js"></script>
         <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.js"></script>
         <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/contrib/auto-render.min.js"></script>
         <script type="text/javascript" src="_static/katex_autorenderer.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90545585-1', 'auto');
  ga('send', 'pageview');

</script>
<img height="1" width="1" style="border-style:none;" alt="" src="http://www.googleadservices.com/pagead/conversion/795629140/?label=txkmCPmdtosBENSssfsC&amp;guid=ON&amp;script=0"/>


  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">Get Started</a></li>
            <li><a href="https://pytorch.org/features">Features</a></li>
            <li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
            <li><a href="https://pytorch.org/blog/">Blog</a></li>
            <li><a href="https://pytorch.org/resources">Resources</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/support">Support</a></li>
            <li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://pytorch.slack.com" target="_blank">Slack</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md" target="_blank">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Follow Us</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="https://www.facebook.com/pytorch" target="_blank" class="facebook"></a>
            <a href="https://twitter.com/pytorch" target="_blank" class="twitter"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="#">Get Started</a>
          </li>

          <li>
            <a href="#">Features</a>
          </li>

          <li>
            <a href="#">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="active">
            <a href="https://pytorch.org/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://pytorch.org/resources">Resources</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>