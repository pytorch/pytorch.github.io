<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-T8XT4PS');</script>
  <!-- End Google Tag Manager -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?">
  <title>
    
      Overview of PyTorch Autograd Engine | PyTorch
    
  </title>
  <meta name="robots" content="index, follow" />

<meta name="description" content="This blog post is based on PyTorch version 1.8, although it should apply for older versions too, since most of the mechanics have remained constant.

" />

  <meta property="og:image" content="https://pytorch.org/assets/images/social-share.jpg" />
  <meta name="twitter:image" content="https://pytorch.org/assets/images/social-share.jpg" />

<meta property="og:locale" content="en_US" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Overview of PyTorch Autograd Engine" />
<meta property="og:description" content="This blog post is based on PyTorch version 1.8, although it should apply for older versions too, since most of the mechanics have remained constant.

" />
<meta property="og:site_name" content="PyTorch" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Overview of PyTorch Autograd Engine" />
<meta name="twitter:description" content="This blog post is based on PyTorch version 1.8, although it should apply for older versions too, since most of the mechanics have remained constant.

" />

  <link rel="stylesheet" href="/assets/main.css">
  <script src="/assets/vendor/jquery.min.js"></script>
  <script src="/assets/vendor/popper.min.js"></script>
  <script src="/assets/vendor/bootstrap.min.js"></script>
  <script src="/assets/vendor/anchor.min.js"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$','$']]
      }
    });
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  
    <script
  async
  src="https://www.googletagmanager.com/gtag/js?id=UA-117752657-2"
></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "UA-117752657-2");
</script>

    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window,document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '243028289693773');
    fbq('track', 'PageView');
</script>

<noscript>
  <img height="1" width="1"
  src="https://www.facebook.com/tr?id=243028289693773&ev=PageView
  &noscript=1"/>
</noscript>

    <!-- Twitter universal website tag code -->
<img height="1" width="1" style="display:none;" alt="" src="https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o2gi1&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0 (https://urldefense.proofpoint.com/v2/url?u=https-3A__analytics.twitter.com_i_adsct-3Fp-5Fid-3DTwitter-26p-5Fuser-5Fid-3D0-26txn-5Fid-3Do2gi1-26events-3D-255B-255B-2522pageview-2522-252Cnull-255D-255D-26tw-5Fsale-5Famount-3D0-26tw-5Forder-5Fquantity-3D0&d=DwMGaQ&c=5VD0RTtNlTh3ycd41b3MUw&r=GMr8XYCDyeQQZuD3noL91A&m=dAJyokk16UvYy-vMrGn_JwYiGfp_eEgo25B9iGDCG-A&s=o6i4D0V0088WH2RnzIoqiF-vj45PL-2sTrsxQ0SNO3A&e=)" />
<img height="1" width="1" style="display:none;" alt="" src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o2gi1&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0 (https://urldefense.proofpoint.com/v2/url?u=https-3A__linkprotect.cudasvc.com_url-3Fa-3Dhttp-253a-252f-252ft.co-252fi-252fadsct-253fp-5Fid-253dTwitter-2526p-5Fuser-5Fid-253d0-2526txn-5Fid-253do2gi1-2526events-253d-25255B-25255B-252522pageview-252522-25252Cnull-25255D-25255D-2526tw-5Fsale-5Famount-253d0-2526tw-5Forder-5Fquantity-253d0-26c-3DE-2C1-2CC33dLwIhtuEcl5FhdztSnUwsioeej5k-2DWy0RYREBAq51kGji32A2Cw94YU9vQBpY5tPN3AukEw3C-5F-2DlbtndnLoR7-5FA-5FLoH0Rr7zLtP1ykptN-26typo-3D1&d=DwMGaQ&c=5VD0RTtNlTh3ycd41b3MUw&r=GMr8XYCDyeQQZuD3noL91A&m=dAJyokk16UvYy-vMrGn_JwYiGfp_eEgo25B9iGDCG-A&s=Abgc3XBkhESv8XBYtLchdDZyISGsK6v_BB6cLMJGyCw&e=)" />
<!-- End Twitter universal website tag code -->

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Pythorch Blog Posts" />
</head>


<body class="blog">
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8XT4PS"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    <div class="main-background blog-background blog-detail-background"></div>
    <div class="hello-bar">
        <div class="container">
          Join us in Silicon Valley September 18-19 at the 2024 PyTorch Conference. <a target="_blank" href="https://events.linuxfoundation.org/pytorch-conference/">Learn more</a>.
        </div>
      </div>
      
    <div class="container-fluid header-holder blog-detail-header">
        <div class="container">
            

<div class="header-container">
  <a class="header-logo" href="https://pytorch.org" aria-label="PyTorch"></a>

  <div class="main-menu">
  <ul>
    <li class="main-menu-item">
      <div id="dropdownMenuButton" data-toggle="resources-dropdown" class="resources-dropdown">
        <a class="with-down-arrow">
          Learn
        </a>
        <div class="resources-dropdown-menu">
          <a class="nav-dropdown-item" href="/get-started">
            <span class=dropdown-title>Get Started</span>
            <p>Run PyTorch locally or get started quickly with one of the supported cloud platforms</p>
          </a>
          <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/">
            <span class="dropdown-title">Tutorials</span>
            <p>Whats new in PyTorch tutorials</p>
          </a>
          <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/basics/intro.html">
            <span class="dropdown-title">Learn the Basics</span>
            <p>Familiarize yourself with PyTorch concepts and modules</p>
          </a>
          <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/recipes/recipes_index.html">
            <span class="dropdown-title">PyTorch Recipes</span>
            <p>Bite-size, ready-to-deploy PyTorch code examples</p>
          </a>
          <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/introyt.html">
            <span class="dropdown-title">Intro to PyTorch - YouTube Series</span>
            <p>Master PyTorch basics with our engaging YouTube tutorial series</p>
          </a>
        </div>
      </div>
    </li>

    <li class="main-menu-item">
      <div id="dropdownMenuButton" data-toggle="resources-dropdown" class="resources-dropdown">
        <a class="with-down-arrow">
          Ecosystem 
        </a>
        <div class="resources-dropdown-menu">
          <a class="nav-dropdown-item" href="/ecosystem">
            <span class="dropdown-title">Tools</span>
            <p>Learn about the tools and frameworks in the PyTorch Ecosystem</p>
          </a>
          <a class="nav-dropdown-item" href="/#community-module">
            <span class=dropdown-title>Community</span>
            <p>Join the PyTorch developer community to contribute, learn, and get your questions answered.</p>
          </a>
          <a class="nav-dropdown-item" href="https://discuss.pytorch.org" target="_blank">
            <span class=dropdown-title>Forums</span>
            <p>A place to discuss PyTorch code, issues, install, research</p>
          </a>
          <a class="nav-dropdown-item" href="/resources">
            <span class=dropdown-title>Developer Resources</span>
            <p>Find resources and get questions answered</p>
          </a>
          <a class="nav-dropdown-item" href="/ecosystem/contributor-awards-2023">
            <span class="dropdown-title">Contributor Awards - 2023</span>
            <p>Award winners announced at this year's PyTorch Conference</p>
          </a>
        </div>
      </div>
    </li>

    <li class="main-menu-item">
      <div id="dropdownMenuButton" data-toggle="resources-dropdown" class="resources-dropdown">
        <a class="with-down-arrow">
          Edge 
        </a>
        <div class="resources-dropdown-menu">
          <a class="nav-dropdown-item" href="/edge">
            <span class="dropdown-title">About PyTorch Edge</span>
            <p>Build innovative and privacy-aware AI experiences for edge devices</p>
          </a>
          <a class="nav-dropdown-item" href="/executorch-overview">
            <span class="dropdown-title">ExecuTorch</span>
            <p>End-to-end solution for enabling on-device inference capabilities across mobile and edge devices</p>
          </a>
        </div>
      </div>
    </li>

    <li class="main-menu-item">
      <div id="docsDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
        <a class="with-down-arrow">
          Docs
        </a>
        <div class="resources-dropdown-menu">
          <a class="nav-dropdown-item" href="https://pytorch.org/docs">
            <span class="dropdown-title">PyTorch</span>
            <p>Explore the documentation for comprehensive guidance on how to use PyTorch.</p>
          </a>
          <a class="nav-dropdown-item" href="/pytorch-domains">
            <span class="dropdown-title">PyTorch Domains</span>
            <p> Read the PyTorch Domains documentation to learn more about domain-specific libraries.</p>
          </a>
        </div>
      </div>
    </li>

    <li class="main-menu-item">
      <div id="dropdownMenuButton" data-toggle="resources-dropdown" class="resources-dropdown">
        <a class="with-down-arrow">
          Blog & News
        </a>
        <div class="resources-dropdown-menu">
          <a class="nav-dropdown-item" href="/blog">
            <span class="dropdown-title">PyTorch Blog</span>
            <p>Catch up on the latest technical news and happenings</p>
          </a>
          <a class="nav-dropdown-item" href="/community-blog">
            <span class="dropdown-title">Community Blog</span>
            <p>Stories from the PyTorch ecosystem</p>
          </a>
          <a class="nav-dropdown-item" href="/videos">
            <span class="dropdown-title">Videos</span>
            <p>Learn about the latest PyTorch tutorials, new, and more </p>
          </a>
          <a class="nav-dropdown-item" href="/community-stories">
            <span class="dropdown-title">Community Stories</span>
            <p>Learn how our community solves real, everyday machine learning problems with PyTorch</p>
          </a>
          <a class="nav-dropdown-item" href="/events">
            <span class=dropdown-title>Events</span>
            <p>Find events, webinars, and podcasts</p>
          </a>
        </div>
      </div>
    </li>

    <li class="main-menu-item">
      <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
        <a class="with-down-arrow">
          About
        </a>
        <div class="resources-dropdown-menu">
          <a class="nav-dropdown-item" href="/foundation">
            <span class=dropdown-title>PyTorch Foundation</span>
            <p>Learn more about the PyTorch Foundation.</p>
          </a>
          <a class="nav-dropdown-item" href="/governing-board">
            <span class=dropdown-title>Governing Board</span>
          </a>
        </div>
      </div>
    </li>

    <li class="main-menu-item">
      <a href="/join" data-cta="join">
        Become a Member
      </a>
    </li>

    <li class="main-menu-item" id="github-main-menu-link">
      <a href="https://github.com/pytorch/pytorch" title="Go to PyTorch GitHub">
        <div id="topnav-gh-icon"></div>
      </a>
    </li>

    <li class="navSearchWrapper reactNavSearchWrapper" key="search">
      <div class="search-border">
        <div id="search-icon"></div>
        <input
          id="search-input"
          type="text"
          title="Search"
        />
        <div id="close-search">X</div>
      </div>
    </li>
  </ul>
</div>

<script src="/assets/main-menu-dropdown.js"></script>


  <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
</div>

        </div>
    </div>

    <div class="jumbotron jumbotron-fluid blog-detail-jumbotron">
        <div class="container blog-detail-container">
            <p class="featured-post">June 08, 2021</p>
            <h1>
                <a class="blog-title">Overview of PyTorch Autograd Engine</a>
            </h1>
        </div>
    </div>

    <div class="main-content-wrapper blog-detail-wrapper">
        <div class="main-content blog-detail-content">
            <div class="container">
                <img src="/assets/images/logo-icon.svg" class="img-fluid author-icon">
                <article class="pytorch-article">
                    <p class="author">
                      by
                      
                        Preferred Networks, Inc.
                      
                    </p>
                    <p>This blog post is based on PyTorch version 1.8, although it should apply for older versions too, since most of the mechanics have remained constant.</p>

<p>To help understand the concepts explained here, it is recommended that you read the awesome blog post by <a href="https://twitter.com/ezyang">@ezyang</a>: <a href="http://blog.ezyang.com/2019/05/pytorch-internals/">PyTorch internals</a> if you are not familiar with PyTorch architecture components such as ATen or c10d.</p>

<h3 id="what-is-autograd">What is autograd?</h3>

<p><strong>Background</strong></p>

<p>PyTorch computes the gradient of a function with respect to the inputs by using automatic differentiation. Automatic differentiation is a technique that, given a computational graph, calculates the gradients of the inputs. Automatic differentiation can be performed in two different ways; forward and reverse mode. Forward mode means that we calculate the gradients along with the result of the function, while reverse mode requires us to evaluate the function first, and then we calculate the gradients starting from the output. While both modes have their pros and cons, the reverse mode is the de-facto choice since the number of outputs is smaller than the number of inputs, which allows a much more efficient computation. Check [3] to learn more about this.</p>

<p>Automatic differentiation relies on a classic calculus formula known as the chain-rule. The chain rule allows us to calculate very complex derivatives by splitting them and recombining them later.</p>

<p>Formally speaking, given a composite function <a href="https://www.codecogs.com/eqnedit.php?latex=f(g(x))" target="_blank"><img src="https://latex.codecogs.com/gif.latex?f(g(x))" title="f(g(x))" /></a>, we can calculate its derivative as <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial}{\partial&space;x}&space;f(g(x))&space;=&space;f'(g(x))g'(x)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial}{\partial&space;x}&space;f(g(x))&space;=&space;f'(g(x))g'(x)" title="\frac{\partial}{\partial x} f(g(x)) = f'(g(x))g'(x)" /></a>. This result is what makes automatic differentiation work.
By combining the derivatives of the simpler functions that compose a larger one, such as a neural network, it is possible to compute the exact value of the gradient at a given point rather than relying on the numerical approximation, which would require multiple perturbations in the input to obtain a value.</p>

<p>To get the intuition of how the reverse mode works, let’s look at a simple function <a href="https://www.codecogs.com/eqnedit.php?latex=f(x,&space;y)&space;=&space;log(x*y)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?f(x,&space;y)&space;=&space;log(x*y)" title="f(x, y) = log(x*y)" /></a>. Figure 1 shows its computational graph where the inputs x, y in the left, flow through a series of operations to generate the output z.</p>

<div class="text-center">
  <img src="/assets/images/f_x_y_graph.png" width="100%" />
  <p>Figure 1: Computational graph of f(x, y) = log(x*y)</p>
</div>

<p>The automatic differentiation engine will normally execute this graph. It will also extend it to calculate the derivatives of w with respect to the inputs x, y, and the intermediate result v.</p>

<p>The example function can be decomposed in f and g, where <a href="https://www.codecogs.com/eqnedit.php?latex=f(x,&space;y)&space;=&space;log(g(x,&space;y))" target="_blank"><img src="https://latex.codecogs.com/gif.latex?f(x,&space;y)&space;=&space;log(g(x,&space;y))" title="f(x, y) = log(g(x, y))" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=g(x,&space;y)&space;=&space;xy" target="_blank"><img src="https://latex.codecogs.com/gif.latex?g(x,&space;y)&space;=&space;xy" title="g(x, y) = xy" /></a>.  Every time the engine executes an operation in the graph, the derivative of that operation is added to the graph to be executed later in the backward pass. Note, that the engine knows the derivatives of the basic functions.</p>

<p>In the example above, when multiplying x and y to obtain v, the engine will extend the graph to calculate the partial derivatives of the multiplication by using the multiplication derivative definition that it already knows. <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial}{\partial&space;x}&space;g(x,&space;y)&space;=&space;y" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial}{\partial&space;x}&space;g(x,&space;y)&space;=&space;y" title="\frac{\partial}{\partial x} g(x, y) = y" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial}{\partial&space;y}&space;g(x,&space;y)&space;=&space;x" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial}{\partial&space;y}&space;g(x,&space;y)&space;=&space;x" title="\frac{\partial}{\partial y} g(x, y) = x" /></a> . The resulting extended graph is shown in Figure 2, where the <em>MultDerivative</em> node also calculates the product of the resulting gradients by an input gradient to apply the chain rule; this will be explicitly seen in the following operations. Note that the backward graph (green nodes) will not be executed until all the forward steps are completed.</p>

<div class="text-center">
  <img src="/assets/images/multi_derivative_graph.png" width="100%" />
  <p>Figure 2: Computational graph extended after executing the logarithm</p>
</div>

<p>Continuing, the engine now calculates the <a href="https://www.codecogs.com/eqnedit.php?latex=log(v)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?log(v)" title="log(v)" /></a> operation and extends the graph again with the log derivative that it knows to be <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{1}{v}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{1}{v}" title="\frac{1}{v}" /></a>. This is shown in figure 3. This operation generates the result <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;w}{\partial&space;v}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;w}{\partial&space;v}" title="\frac{\partial w}{\partial v}" /></a> that when propagated backward and multiplied by the multiplication derivative as in the chain rule, generates the derivatives <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;w}{\partial&space;x}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;w}{\partial&space;x}" title="\frac{\partial w}{\partial x}" /></a>, <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;w}{\partial&space;x}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;w}{\partial&space;x}" title="\frac{\partial w}{\partial x}" /></a>.</p>

<div class="text-center">
  <img src="/assets/images/extended_computational_graph.png" width="100%" />
  <p>Figure 3: Computational graph extended after executing the logarithm</p>
</div>

<p>The original computation graph is extended with a new dummy variable z that is the same w. The derivative of z with respect to w is 1 as they are the same variable, this trick allows us to apply the chain rule to calculate the derivatives of the inputs. After the forward pass is complete, we start the backward pass, by supplying the initial value of 1.0 for <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;z}{\partial&space;w}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;z}{\partial&space;w}" title="\frac{\partial z}{\partial w}" /></a>. This is shown in Figure 4.</p>

<div class="text-center">
  <img src="/assets/images/computational_graph_reverse_auto_differentiation.png" width="100%" />
  <p>Figure 4: Computational graph extended for reverse auto differentiation</p>
</div>

<p>Then following the green graph we execute the LogDerivative operation <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{1}{v}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{1}{v}" title="\frac{1}{v}" /></a> that the auto differentiation engine introduced, and multiply its result by <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;z}{\partial&space;w}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;z}{\partial&space;w}" title="\frac{\partial z}{\partial w}" /></a> to obtain the gradient <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;z}{\partial&space;v}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;z}{\partial&space;v}" title="\frac{\partial z}{\partial v}" /></a> as per the chain rule states. Next, the multiplication derivative is executed in the same way, and the desired derivatives <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;z}{\partial&space;x}&space;\frac{\partial&space;z}{\partial&space;y}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;z}{\partial&space;x}&space;\frac{\partial&space;z}{\partial&space;y}" title="\frac{\partial z}{\partial x} \frac{\partial z}{\partial y}" /></a> are finally obtained.</p>

<p>Formally, what we are doing here, and PyTorch autograd engine also does, is computing a Jacobian-vector product (Jvp) to calculate the gradients of the model parameters, since the model parameters and inputs are vectors.</p>

<p><strong>The Jacobian-vector product</strong></p>

<p>When we calculate the gradient of a vector-valued function <a href="https://www.codecogs.com/eqnedit.php?latex=f(\overline{x})&space;=&space;\overline{y}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?f(\overline{x})&space;=&space;\overline{y}" title="f(\overline{x}) = \overline{y}" /></a> (a function whose inputs and outputs are vectors), we are essentially constructing a Jacobian matrix .</p>

<p>Thanks to the chain rule, multiplying the Jacobian matrix of a function <a href="https://www.codecogs.com/eqnedit.php?latex=f(\overline{x})&space;=&space;\overline{y}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?f(\overline{x})&space;=&space;\overline{y}" title="f(\overline{x}) = \overline{y}" /></a> by a vector <a href="https://www.codecogs.com/eqnedit.php?latex=v" target="_blank"><img src="https://latex.codecogs.com/gif.latex?v" title="v" /></a> with the previously calculated gradients of a scalar function <a href="https://www.codecogs.com/eqnedit.php?latex=z&space;=&space;g(\overline{y})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?z&space;=&space;g(\overline{y})" title="z = g(\overline{y})" /></a> results in the gradients <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;z}{\partial&space;x_1}&space;\cdots&space;\frac{\partial&space;z}{\partial&space;x_n}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;z}{\partial&space;x_1}&space;\cdots&space;\frac{\partial&space;z}{\partial&space;x_n}" title="\frac{\partial z}{\partial x_1} \cdots \frac{\partial z}{\partial x_n}" /></a> of the scalar output with respect to the vector-valued function inputs.</p>

<p>As an example, let’s look at some functions in python notation to show how the chain rule applies.</p>
<div class="outlined-code-block">
  <a href="https://www.codecogs.com/eqnedit.php?latex=f(x_1,&space;x_2)&space;=&space;(log(x_1&space;x_2),&space;sin(x_2))" target="_blank"><img src="https://latex.codecogs.com/gif.latex?f(x_1,&space;x_2)&space;=&space;(log(x_1&space;x_2),&space;sin(x_2))" title="f(x_1, x_2) = (log(x_1 x_2), sin(x_2))" /></a>

  <pre>def f(x1, x2):
      a = x1 * x2
      y1 = log(a)
      y2 = sin(x2)
      return (y1, y2)
  </pre>

  <a href="https://www.codecogs.com/eqnedit.php?latex=g(y_1,&space;y_2)&space;=&space;y_1&space;y_2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?g(y_1,&space;y_2)&space;=&space;y_1&space;y_2" title="g(y_1, y_2) = y_1 y_2" /></a>

  <pre>def g(y1, y2):
      return y1 * y2
  </pre>

</div>

<p>Now, if we derive this by hand using the chain rule and the definition of the derivatives, we obtain the following set of identities that we can directly plug into the Jacobian matrix of <a href="https://www.codecogs.com/eqnedit.php?latex=f(x_1,&space;x_2)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?f(x_1,&space;x_2)" title="f(x_1, x_2)" /></a></p>

<div class="outlined-code-block">
  <p><a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;y_1}{\partial&space;x_1}&space;=&space;\frac{\partial&space;y_1}{\partial&space;a}\frac{\partial&space;a}{\partial&space;x_1}&space;=&space;\frac{1}{x_1}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;y_1}{\partial&space;x_1}&space;=&space;\frac{\partial&space;y_1}{\partial&space;a}\frac{\partial&space;a}{\partial&space;x_1}&space;=&space;\frac{1}{x_1}" title="\frac{\partial y_1}{\partial x_1} = \frac{\partial y_1}{\partial a}\frac{\partial a}{\partial x_1} = \frac{1}{x_1}" /></a></p>
  <p><a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;y_1}{\partial&space;x_2}&space;=&space;\frac{\partial&space;y_1}{\partial&space;a}\frac{\partial&space;a}{\partial&space;x_2}&space;=&space;\frac{1}{x_2}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;y_1}{\partial&space;x_2}&space;=&space;\frac{\partial&space;y_1}{\partial&space;a}\frac{\partial&space;a}{\partial&space;x_2}&space;=&space;\frac{1}{x_2}" title="\frac{\partial y_1}{\partial x_2} = \frac{\partial y_1}{\partial a}\frac{\partial a}{\partial x_2} = \frac{1}{x_2}" /></a></p>
  <p><a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;y_2}{\partial&space;x_1}&space;=&space;0" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;y_2}{\partial&space;x_1}&space;=&space;0" title="\frac{\partial y_2}{\partial x_1} = 0" /></a></p>
  <p><a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;y_2}{\partial&space;x_2}&space;=&space;cos(x_2)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;y_2}{\partial&space;x_2}&space;=&space;cos(x_2)" title="\frac{\partial y_2}{\partial x_2} = cos(x_2)" /></a></p>
</div>

<p>Next, let’s consider the gradients for the scalar function <a href="https://www.codecogs.com/eqnedit.php?latex=z&space;=&space;g(y_1,&space;y_2)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?z&space;=&space;g(y_1,&space;y_2)" title="z = g(y_1, y_2)" /></a></p>

<div class="outlined-code-block">
  <p><a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;z}{y_1}&space;=&space;y_2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;z}{y_1}&space;=&space;y_2" title="\frac{\partial z}{y_1} = y_2" /></a></p>
  <p><a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;z}{y_2}&space;=&space;y_1" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;z}{y_2}&space;=&space;y_1" title="\frac{\partial z}{y_2} = y_1" /></a></p>
</div>

<p>If we now calculate the transpose-Jacobian vector product obeying the chain rule, we obtain the following expression:</p>
<div style="overflow:scroll">
  <a href="https://www.codecogs.com/eqnedit.php?latex=\begin{pmatrix}\frac{\partial&space;y_1}{\partial&space;x_1}&space;&amp;&space;\frac{\partial&space;y_1}{\partial&space;x_2}&space;\\\\&space;\frac{\partial&space;y_2}{\partial&space;x_1}&space;&amp;&space;\frac{\partial&space;y_2}{\partial&space;x_2}&space;\end{pmatrix}^{t}&space;\begin{pmatrix}&space;y_2\\y_1&space;\end{pmatrix}&space;=&space;\begin{pmatrix}\frac{1}{x_1}&space;&amp;&space;\frac{1}{x_2}&space;\\\\&space;0&space;&amp;&space;cos(x_2))&space;\end{pmatrix}^{t}&space;\begin{pmatrix}&space;y_2\\y_1&space;\end{pmatrix}&space;=&space;\begin{pmatrix}&space;\frac{1}{x_1}y_2\\\frac{1}{x_2}y_2&plus;cos(x_2)y_1&space;\end{pmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\begin{pmatrix}\frac{\partial&space;y_1}{\partial&space;x_1}&space;&amp;&space;\frac{\partial&space;y_1}{\partial&space;x_2}&space;\\\\&space;\frac{\partial&space;y_2}{\partial&space;x_1}&space;&amp;&space;\frac{\partial&space;y_2}{\partial&space;x_2}&space;\end{pmatrix}^{t}&space;\begin{pmatrix}&space;y_2\\y_1&space;\end{pmatrix}&space;=&space;\begin{pmatrix}\frac{1}{x_1}&space;&amp;&space;\frac{1}{x_2}&space;\\\\&space;0&space;&amp;&space;cos(x_2))&space;\end{pmatrix}^{t}&space;\begin{pmatrix}&space;y_2\\y_1&space;\end{pmatrix}&space;=&space;\begin{pmatrix}&space;\frac{1}{x_1}y_2\\\frac{1}{x_2}y_2&plus;cos(x_2)y_1&space;\end{pmatrix}" title="\begin{pmatrix}\frac{\partial y_1}{\partial x_1} &amp; \frac{\partial y_1}{\partial x_2} \\\\ \frac{\partial y_2}{\partial x_1} &amp; \frac{\partial y_2}{\partial x_2} \end{pmatrix}^{t} \begin{pmatrix} y_2\\y_1 \end{pmatrix} = \begin{pmatrix}\frac{1}{x_1} &amp; \frac{1}{x_2} \\\\ 0 &amp; cos(x_2)) \end{pmatrix}^{t} \begin{pmatrix} y_2\\y_1 \end{pmatrix} = \begin{pmatrix} \frac{1}{x_1}y_2\\\frac{1}{x_2}y_2+cos(x_2)y_1 \end{pmatrix}" /></a>
</div>

<p>Evaluating the Jvp for <a href="https://www.codecogs.com/eqnedit.php?latex=(x_1,&space;x_2)&space;=&space;(0.5,&space;0.75)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?(x_1,&space;x_2)&space;=&space;(0.5,&space;0.75)" title="(x_1, x_2) = (0.5, 0.75)" /></a> yields the result:
<a href="https://www.codecogs.com/eqnedit.php?latex=(\frac{dy}{x_1},&space;\frac{dy}{x_2})&space;=&space;(1.3633,&space;0.1912)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?(\frac{dy}{x_1},&space;\frac{dy}{x_2})&space;=&space;(1.3633,&space;0.1912)" title="(\frac{dy}{x_1}, \frac{dy}{x_2}) = (1.3633, 0.1912)" /></a>
We can execute the same expression in PyTorch and calculate the gradient of the input:</p>
<div class="outlined-code-block">
  <pre>&gt;&gt;&gt; import torch</pre>
  <pre>&gt;&gt;&gt; x = torch.tensor([0.5, 0.75], requires_grad=True)</pre>
  <pre>&gt;&gt;&gt; y = torch.log(x[0] * x[1]) * torch.sin(x[1])</pre>
  <pre>&gt;&gt;&gt; y.backward(1.0)</pre>
  <pre>&gt;&gt;&gt; x.grad</pre>
  tensor([1.3633,
          0.1912])&lt;/pre&gt;
</div>

<p>The result is the same as our hand-calculated Jacobian-vector product!
However, PyTorch never constructed the matrix as it could grow prohibitively large but instead, created a graph of operations that traversed backward while applying the Jacobian-vector products defined in <a href="https://github.com/pytorch/pytorch/blob/master/tools/autograd/derivatives.yaml">tools/autograd/derivatives.yaml</a>.</p>

<p><strong>Going through the graph</strong></p>

<p>Every time PyTorch executes an operation, the autograd engine constructs the graph to be traversed backward.
The reverse mode auto differentiation starts by adding a scalar variable at the end <a href="https://www.codecogs.com/eqnedit.php?latex=z&space;=&space;w" target="_blank"><img src="https://latex.codecogs.com/gif.latex?z&space;=&space;w" title="z = w" /></a> so that <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;z}{\partial&space;w}&space;=&space;1" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;z}{\partial&space;w}&space;=&space;1" title="\frac{\partial z}{\partial w} = 1" /></a> as we saw in the introduction. This is the initial gradient value that is supplied to the Jvp engine calculation as we saw in the section above.</p>

<p>In PyTorch, the initial gradient is explicitly set by the user when he calls the backward method.</p>

<p>Then, the Jvp calculation starts but it never constructs the matrix. Instead, when PyTorch records the computational graph, the derivatives of the executed forward operations are added (Backward Nodes). Figure 5 shows a backward graph generated by the execution of the functions <a href="https://www.codecogs.com/eqnedit.php?latex=f(x_1,&space;x_2)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?f(x_1,&space;x_2)" title="f(x_1, x_2)" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=g(y_1,&space;y_2)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?g(y_1,&space;y_2)" title="g(y_1, y_2)" /></a> seen before.</p>

<div class="text-center">
  <img src="/assets/images/computational_graph_backward_pass.png" width="100%" />
  <p>Figure 5: Computational Graph extended with the backward pass</p>
</div>

<p>Once the forward pass is done, the results are used in the backward pass where the derivatives in the computational graph are executed. The basic derivatives are stored in the <a href="https://github.com/pytorch/pytorch/blob/master/tools/autograd/derivatives.yaml">tools/autograd/derivatives.yaml</a> file and they are not regular derivatives but the Jvp versions of them [3]. They take their primitive function inputs and outputs as parameters along with the gradient of the function outputs with respect to the final outputs. By repeatedly multiplying the resulting gradients by the next Jvp derivatives in the graph, the gradients up to the inputs will be generated following the chain rule.</p>

<div class="text-center">
  <img src="/assets/images/chain_rule_backward_differentiation.png" width="100%" />
  <p>Figure 6: How the chain rule is applied in backward differentiation</p>
</div>

<p>Figure 6 represents the process by showing the chain rule. We started with a value of 1.0 as detailed before which is the already calculated gradient <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;y}{\partial&space;u}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;y}{\partial&space;u}" title="\frac{\partial y}{\partial u}" /></a> highlighted in green. And we move to the next node in the graph. The <em>backward</em> function registered in <a href="https://github.com/pytorch/pytorch/blob/a0a7a2d648f05b0192e6943c9684406cdf404fbf/tools/autograd/derivatives.yaml#L635-L636">derivatives.yaml</a> will calculate the associated
<a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;u}{\partial&space;v}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;u}{\partial&space;v}" title="\frac{\partial u}{\partial v}" /></a> value highlighted in red and multiply it by <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;y}{\partial&space;u}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;y}{\partial&space;u}" title="\frac{\partial y}{\partial u}" /></a>. By the chain rule this results in <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;y}{\partial&space;v}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;y}{\partial&space;v}" title="\frac{\partial y}{\partial v}" /></a> which will be the already calculated gradient (green) when we process the next backward node in the graph.</p>

<p>You may also have noticed that in Figure 5 there is a gradient generated from two different sources. When two different functions share an input, the gradients with respect to the output are aggregated for that input, and calculations using that gradient can’t proceed unless all the paths have been aggregated together.</p>

<p>Let’s see an example of how the derivatives are stored in PyTorch.</p>

<p>Suppose that we are currently processing the backward propagation of the <a href="https://www.codecogs.com/eqnedit.php?latex=log" target="_blank"><img src="https://latex.codecogs.com/gif.latex?log" title="log" /></a> function, in the <em>LogBackward</em> node in Figure 2.  The derivative of <a href="https://www.codecogs.com/eqnedit.php?latex=log" target="_blank"><img src="https://latex.codecogs.com/gif.latex?log" title="log" /></a> in <a href="https://github.com/pytorch/pytorch/blob/a0a7a2d648f05b0192e6943c9684406cdf404fbf/tools/autograd/derivatives.yaml#L635-L636"><code class="language-plaintext highlighter-rouge">derivatives.yaml</code></a> is specified as <code class="language-plaintext highlighter-rouge">grad.div(self.conj())</code>. <code class="language-plaintext highlighter-rouge">grad</code> is the already calculated gradient <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;z}{\partial&space;y1}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;z}{\partial&space;y1}" title="\frac{\partial z}{\partial y1}" /></a> and <code class="language-plaintext highlighter-rouge">self.conj()</code> is the complex conjugate of the input vector. For complex numbers PyTorch calculates a special derivative called the conjugate Wirtinger derivative [6]. This derivative takes the complex number and its conjugate and by operating some magic that is described in [6], they are the direction of steepest descent when plugged into optimizers.</p>

<p>This code translates to <a href="https://www.codecogs.com/eqnedit.php?latex=(\frac{\partial&space;z}{\partial&space;y1}&space;\frac{1}{v})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?(\frac{\partial&space;z}{\partial&space;y1}&space;\frac{1}{v})" title="(\frac{\partial z}{\partial y1} \frac{1}{v})" /></a>, the corresponding green, and red squares in Figure 3. Continuing, the autograd engine will execute the next operation; backward of the multiplication. As before, the inputs are the original function’s inputs and the gradient calculated from the <a href="https://www.codecogs.com/eqnedit.php?latex=log" target="_blank"><img src="https://latex.codecogs.com/gif.latex?log" title="log" /></a> backward step. This step will keep repeating until we reach the gradient with respect to the inputs and the computation will be finished. The gradient of <a href="https://www.codecogs.com/eqnedit.php?latex=\frac{\partial&space;z}{x2}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\frac{\partial&space;z}{x2}" title="\frac{\partial z}{x2}" /></a> is only completed once the multiplication and sin gradients are added together. As you can see, we computed the equivalent of the Jvp but without constructing the matrix.</p>

<p>In the next post we will dive inside PyTorch code to see how this graph is constructed and where are the relevant pieces should you want to experiment with it!</p>

<h3 id="references">References</h3>

<ol class="reference-list">
  <li><a href="https://pytorch.org/tutorials/beginner/blitz/autograd_tutorial.html">https://pytorch.org/tutorials/beginner/blitz/autograd_tutorial.html</a></li>
  <li><a href="https://web.stanford.edu/class/cs224n/readings/gradient-notes.pdf">https://web.stanford.edu/class/cs224n/readings/gradient-notes.pdf</a></li>
  <li><a href="https://www.cs.toronto.edu/~rgrosse/courses/csc321_2018/slides/lec10.pdf">https://www.cs.toronto.edu/~rgrosse/courses/csc321_2018/slides/lec10.pdf</a></li>
  <li><a href="https://mustafaghali11.medium.com/how-pytorch-backward-function-works-55669b3b7c62">https://mustafaghali11.medium.com/how-pytorch-backward-function-works-55669b3b7c62</a></li>
  <li><a href="https://indico.cern.ch/event/708041/contributions/3308814/attachments/1813852/2963725/automatic_differentiation_and_deep_learning.pdf">https://indico.cern.ch/event/708041/contributions/3308814/attachments/1813852/2963725/automatic_differentiation_and_deep_learning.pdf</a></li>
  <li><a href="https://pytorch.org/docs/stable/notes/autograd.html#complex-autograd-doc">https://pytorch.org/docs/stable/notes/autograd.html#complex-autograd-doc</a></li>
  <p>Recommended: shows why the backprop is formally expressed with the Jacobian</p>
  <li><a href="https://www.cs.ubc.ca/~fwood/CS340/lectures/AD1.pdf">https://cs.ubc.ca/~fwood/CS340/lectures/AD1.pdf</a></li>
</ol>

                </article>
            </div>
        </div>
    </div>

<!--    


 -->
    <div class="container-fluid docs-tutorials-resources">
  <div class="container">
    <div class="row">
      <div class="col-md-4 text-center">
        <h2>Docs</h2>
        <p>Access comprehensive developer documentation for PyTorch</p>
        <a class="with-right-arrow" href="/docs">View Docs</a>
      </div>

      <div class="col-md-4 text-center">
        <h2>Tutorials</h2>
        <p>Get in-depth tutorials for beginners and advanced developers</p>
        <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
      </div>

      <div class="col-md-4 text-center">
        <h2>Resources</h2>
        <p>Find development resources and get your questions answered</p>
        <a class="with-right-arrow" href="/resources">View Resources</a>
      </div>
    </div>
  </div>
</div>

<footer class="site-footer">
  <div class="container footer-container">
    <div class="lf-grid">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org" class="footer-logo">
          <img src="/assets/images/logo-icon.svg" alt="PyTorch logo" width="40">
        </a>
      </div>

      <ul class="social-links">
        <li><a href="https://www.facebook.com/pytorch" target="_blank" title="PyTorch on Facebook">
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="-0.51 -0.26 26.45 26.45" aria-label="Facebook"><path fill="currentColor" d="M25.497 13.075c0-2.45-.698-4.848-2.011-6.911a12.765 12.765 0 0 0-5.398-4.73A12.671 12.671 0 0 0 11.008.38a12.705 12.705 0 0 0-6.529 2.95A12.827 12.827 0 0 0 .563 9.358a12.896 12.896 0 0 0-.07 7.201 12.831 12.831 0 0 0 3.801 6.103 12.709 12.709 0 0 0 6.471 3.078v-8.957H7.53v-3.708h3.235v-2.824c0-3.213 1.903-4.988 4.813-4.988.956.014 1.909.097 2.852.25V8.67h-1.607a1.83 1.83 0 0 0-1.518.497 1.854 1.854 0 0 0-.561 1.505v2.404h3.535l-.563 3.708h-2.97v8.957a12.725 12.725 0 0 0 7.697-4.337 12.87 12.87 0 0 0 3.054-8.328z"/></svg>	
        </a></li>
        <li><a href="https://twitter.com/pytorch" target="_blank" title="PyTorch on X">
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 300 300" aria-label="X"><path fill="currentColor" d="M178.57 127.15 290.27 0h-26.46l-97.03 110.38L89.34 0H0l117.13 166.93L0 300.25h26.46l102.4-116.59 81.8 116.59h89.34M36.01 19.54H76.66l187.13 262.13h-40.66"/></svg>
        </a></li>
        <li><a href="https://www.youtube.com/pytorch" target="_blank" title="PyTorch on YouTube">
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="0.21 0.27 34.45 25.07" aria-label="YouTube"><path fill="currentColor" d="M33.729 6.084s-.327-2.33-1.317-3.356a4.691 4.691 0 0 0-3.32-1.432c-4.634-.34-11.589-.34-11.589-.34h-.014s-6.954 0-11.59.342a4.692 4.692 0 0 0-3.32 1.432c-.993 1.025-1.315 3.354-1.315 3.354a52.189 52.189 0 0 0-.331 5.473v2.566c.014 1.829.125 3.656.331 5.472 0 0 .322 2.33 1.316 3.36 1.26 1.345 2.916 1.3 3.653 1.445 2.65.26 11.263.34 11.263.34s6.96-.01 11.597-.353a4.691 4.691 0 0 0 3.32-1.432c.993-1.026 1.316-3.356 1.316-3.356.206-1.817.316-3.644.33-5.473v-2.57a52.26 52.26 0 0 0-.33-5.472zM14.076 17.232V7.729l8.951 4.768-8.95 4.735z"/></svg>	
        </a></li>
        <li><a href="https://www.linkedin.com/company/pytorch" target="_blank" title="PyTorch on LinkedIn">
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="-10.23 -10.23 531.96 531.96" aria-label="LinkedIn"><rect width="512" height="512" rx="0" fill="currentColor"/><circle fill="#000" cx="142" cy="138" r="37"/><path stroke="#000" stroke-width="66" d="M244 194v198M142 194v198"/><path fill="#000" d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
        </a></li>
        <li><a href="https://social.lfx.dev/@pytorch" rel="me" target="_blank" title="PyTorch on Mastodon">
          <svg fill="currentColor" aria-label="Mastodon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xml:space="preserve"><path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/></svg>
        </a></li>
      </ul>
    </div>

    <div class="privacy-policy">
      <div class="copyright">
        <p>© Copyright The Linux Foundation. The PyTorch Foundation is a project of The Linux Foundation. 
          For web site terms of use, trademark policy and other policies applicable to The PyTorch Foundation please see 
          <a href="https://www.linuxfoundation.org/legal/policies/">Linux Foundation Policies</a>. The PyTorch Foundation supports the PyTorch open source 
          project, which has been established as PyTorch Project a Series of LF Projects, LLC. For policies applicable to the PyTorch Project a Series of LF Projects, LLC, 
          please see <a href="https://www.lfprojects.org/policies/">LF Projects, LLC Policies</a>. <a href="https://www.linuxfoundation.org/privacy">Privacy Policy</a> and <a href="https://www.linuxfoundation.org/terms">Terms of Use</a>.</p>
      </div>
    </div>
  </div>
  <img height="1" width="1" style="border-style:none;" alt="" src="https://www.googleadservices.com/pagead/conversion/795629140/?label=txkmCPmdtosBENSssfsC&amp;guid=ON&amp;script=0"/>

</footer>

<div class="mobile-main-menu">
  <div class="container-fluid">
    <div class="container">
      <div class="mobile-main-menu-header-container">
        <a class="header-logo" href="https://pytorch.org" aria-label="PyTorch"></a>
        <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
      </div>
    </div>
  </div>

  <div class="mobile-main-menu-links-container">

    <div class="main-menu">
      <ul>
        <li class="navSearchWrapper reactNavSearchWrapper tabletSearchWrapper" key="search">
          <div class="mobile-search-border">
            <input
              id="mobile-search-input"
              type="text"
              title="Search"
            />
            <div id="mobile-search-icon"></div>
          </div>
        </li>

        <li class="resources-mobile-menu-title">
          <a>Learn</a>
        </li>
        <ul class="resources-mobile-menu-items">
          <li>
            <a href="/get-started">Get Started</a> 
          </li>
          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>
          <li>
            <a href="https://pytorch.org/tutorials/beginner/basics/intro.html">Learn the Basics</a>
          </li>
          <li>
            <a href="https://pytorch.org/tutorials/recipes/recipes_index.html">PyTorch Recipes</a>
          </li>
          <li>
            <a href="https://pytorch.org/tutorials/beginner/introyt.html">Introduction to PyTorch - YouTube Series</a>
          </li>
        </ul>
        <li class="resources-mobile-menu-title">
          <a>Ecosystem</a>
        </li>
        <ul class="resources-mobile-menu-items">
          <li>
            <a href="/ecosystem">Tools</a>
          </li>
          <li>
            <a href="/#community-module">Community</a>
          </li>
          <li>
            <a href="https://discuss.pytorch.org">Forums</a>
          </li>
          <li>
            <a href="/resources">Developer Resources</a>
          </li>
          <li>
            <a href="/ecosystem/contributor-awards-2023">Contributor Awards - 2023</a>
          </li>
        </ul>
        <li class="resources-mobile-menu-title">
          <a>Edge</a>
        </li>
        <ul class="resources-mobile-menu-items">
          <li>
            <a href="/edge">About PyTorch Edge</a>
          </li>
          <li>
            <a href="/executorch-overview">ExecuTorch</a>
          </li>
        </ul>
        <li class="resources-mobile-menu-title">
          <a>Docs</a>
        </li>
        <ul class="resources-mobile-menu-items">
          <li>
            <a href="https://pytorch.org/docs">PyTorch</a>
          </li>
          <li>
            <a href="/pytorch-domains">PyTorch Domains</a>
          </li>
        </ul>

        <li class="resources-mobile-menu-title">
          <a>Blog & News</a>
        </li>
        <ul class="resources-mobile-menu-items">
          <li>
            <a href="/blog">PyTorch Blog</a>
          </li>
          <li>
            <a href="/community-blog">Community Blog</a>
          </li>
          <li>
            <a href="/videos">Videos</a>
          </li>
          <li>
            <a href="/community-stories">Community Stories</a>
          </li>
          <li>
            <a href="/events">Events</a>
          </li>
        </ul>
        <li class="resources-mobile-menu-title">
          <a>About</a>
        </li>
        <ul class="resources-mobile-menu-items">
          <li>
            <a href="/foundation">PyTorch Foundation</a>
          </li>
          <li>
            <a href="/governing-board">Governing Board</a>
          </li>
        </ul>
        <li class="resources-mobile-menu-title">
          <a href="/join">Become a Member</a>
        </li>
        <li class="resources-mobile-menu-title">
          <a href="https://github.com/pytorch/pytorch" title="Go to PyTorch GitHub"><div id="topnav-gh-icon"></div></a>
        </li>

      </ul>
    </div>

  </div>
</div>


<script src="/assets/mobile-menu.js"></script>
<script src="/assets/scroll-to-anchor.js"></script>
<script src="/assets/external-links-new-tab.js"></script>

  <script src="/assets/search-bar.js"></script>

<script src="/assets/cookie-banner.js"></script>

<script type="text/javascript">
  mobileMenu.bind();
  anchors.add('.pytorch-article h2, .pytorch-article h3, .pytorch-article h4, .pytorch-article h5');

  // Add class to links that have code blocks, since we cannot create links in code blocks
  $("a code.highlighter-rouge").each(function(e) {
    $(this).closest("a").addClass("has-code");
  });

  scrollToAnchor.bind();

  var hasStaticHeader = $(".blog-header, .blog-detail-header, .resources-header, .get-started-header, .features-header, .ecosystem-header, .hub-header, .mobile-header, .announcement-header, .comm-stories-header").length > 0;

  if (!hasStaticHeader) {
    $(window).on("scroll", function() {
      var top = $(this).scrollTop();
      var fullPosition = $(".main-background").height() - $(".header-holder").height();

      if (top <= 40) {
        $(".header-holder").css({"backgroundColor": "rgba(0, 0, 0, 0.165)"});
      } else if (top >= fullPosition) {
        $(".header-holder").css({"backgroundColor": "#000000"});
      } else {
        var bgColor = "rgba(0, 0, 0, " + top / fullPosition + ")";
        $(".header-holder").css({"backgroundColor": bgColor});
      }
    });
  }
</script>


  <script src="/assets/track-events.js"></script>
  <script>trackEvents.bind();</script>



<div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="/assets/images/pytorch-x.svg">
  </div>
</div>


</body>

</html>
