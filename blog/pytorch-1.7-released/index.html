<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-T8XT4PS');</script>
  <!-- End Google Tag Manager -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?">
  <title>
    
      PyTorch 1.7 released w/ CUDA 11, New APIs for FFTs, Windows support for Distributed training and more | PyTorch
    
  </title>
  <meta name="robots" content="index, follow" />

<meta name="description" content="Today, we’re announcing the availability of PyTorch 1.7, along with updated domain libraries. The PyTorch 1.7 release includes a number of new APIs including support for NumPy-Compatible FFT operations, profiling tools and major updates to both distributed data parallel (DDP) and remote procedure call (RPC) based distributed training. In addition, several features moved to stable including custom C++ Classes, the memory profiler, extensions via custom tensor-like objects, user async functions in RPC and a number of other features in torch.distributed such as Per-RPC timeout, DDP dynamic bucketing and RRef helper.

" />

  <meta property="og:image" content="https://pytorch.org/assets/images/social-share.jpg" />
  <meta name="twitter:image" content="https://pytorch.org/assets/images/social-share.jpg" />

<meta property="og:locale" content="en_US" />
<meta property="og:type" content="website" />
<meta property="og:title" content="PyTorch 1.7 released w/ CUDA 11, New APIs for FFTs, Windows support for Distributed training and more" />
<meta property="og:description" content="Today, we’re announcing the availability of PyTorch 1.7, along with updated domain libraries. The PyTorch 1.7 release includes a number of new APIs including support for NumPy-Compatible FFT operations, profiling tools and major updates to both distributed data parallel (DDP) and remote procedure call (RPC) based distributed training. In addition, several features moved to stable including custom C++ Classes, the memory profiler, extensions via custom tensor-like objects, user async functions in RPC and a number of other features in torch.distributed such as Per-RPC timeout, DDP dynamic bucketing and RRef helper.

" />
<meta property="og:site_name" content="PyTorch" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="PyTorch 1.7 released w/ CUDA 11, New APIs for FFTs, Windows support for Distributed training and more" />
<meta name="twitter:description" content="Today, we’re announcing the availability of PyTorch 1.7, along with updated domain libraries. The PyTorch 1.7 release includes a number of new APIs including support for NumPy-Compatible FFT operations, profiling tools and major updates to both distributed data parallel (DDP) and remote procedure call (RPC) based distributed training. In addition, several features moved to stable including custom C++ Classes, the memory profiler, extensions via custom tensor-like objects, user async functions in RPC and a number of other features in torch.distributed such as Per-RPC timeout, DDP dynamic bucketing and RRef helper.

" />

  <link rel="stylesheet" href="/assets/main.css">
  <script src="/assets/vendor/jquery.min.js"></script>
  <script src="/assets/vendor/popper.min.js"></script>
  <script src="/assets/vendor/bootstrap.min.js"></script>
  <script src="/assets/vendor/anchor.min.js"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$','$']]
      }
    });
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  
    <script
  async
  src="https://www.googletagmanager.com/gtag/js?id=UA-117752657-2"
></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "UA-117752657-2");
</script>

    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window,document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '243028289693773');
    fbq('track', 'PageView');
</script>

<noscript>
  <img height="1" width="1"
  src="https://www.facebook.com/tr?id=243028289693773&ev=PageView
  &noscript=1"/>
</noscript>

    <!-- Twitter universal website tag code -->
<img height="1" width="1" style="display:none;" alt="" src="https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o2gi1&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0 (https://urldefense.proofpoint.com/v2/url?u=https-3A__analytics.twitter.com_i_adsct-3Fp-5Fid-3DTwitter-26p-5Fuser-5Fid-3D0-26txn-5Fid-3Do2gi1-26events-3D-255B-255B-2522pageview-2522-252Cnull-255D-255D-26tw-5Fsale-5Famount-3D0-26tw-5Forder-5Fquantity-3D0&d=DwMGaQ&c=5VD0RTtNlTh3ycd41b3MUw&r=GMr8XYCDyeQQZuD3noL91A&m=dAJyokk16UvYy-vMrGn_JwYiGfp_eEgo25B9iGDCG-A&s=o6i4D0V0088WH2RnzIoqiF-vj45PL-2sTrsxQ0SNO3A&e=)" />
<img height="1" width="1" style="display:none;" alt="" src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o2gi1&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0 (https://urldefense.proofpoint.com/v2/url?u=https-3A__linkprotect.cudasvc.com_url-3Fa-3Dhttp-253a-252f-252ft.co-252fi-252fadsct-253fp-5Fid-253dTwitter-2526p-5Fuser-5Fid-253d0-2526txn-5Fid-253do2gi1-2526events-253d-25255B-25255B-252522pageview-252522-25252Cnull-25255D-25255D-2526tw-5Fsale-5Famount-253d0-2526tw-5Forder-5Fquantity-253d0-26c-3DE-2C1-2CC33dLwIhtuEcl5FhdztSnUwsioeej5k-2DWy0RYREBAq51kGji32A2Cw94YU9vQBpY5tPN3AukEw3C-5F-2DlbtndnLoR7-5FA-5FLoH0Rr7zLtP1ykptN-26typo-3D1&d=DwMGaQ&c=5VD0RTtNlTh3ycd41b3MUw&r=GMr8XYCDyeQQZuD3noL91A&m=dAJyokk16UvYy-vMrGn_JwYiGfp_eEgo25B9iGDCG-A&s=Abgc3XBkhESv8XBYtLchdDZyISGsK6v_BB6cLMJGyCw&e=)" />
<!-- End Twitter universal website tag code -->

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Pythorch Blog Posts" />
</head>


<body class="blog">
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8XT4PS"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    <div class="main-background blog-background blog-detail-background"></div>
    <div class="hello-bar">
        <div class="container">
          Join us in Silicon Valley September 18-19 at the 2024 PyTorch Conference. <a target="_blank" href="https://events.linuxfoundation.org/pytorch-conference/">Learn more</a>.
        </div>
      </div>
      
    <div class="container-fluid header-holder blog-detail-header">
        <div class="container">
            

<div class="header-container">
  <a class="header-logo" href="https://pytorch.org" aria-label="PyTorch"></a>

  <div class="main-menu">
  <ul>
    <li class="main-menu-item">
      <div id="dropdownMenuButton" data-toggle="resources-dropdown" class="resources-dropdown">
        <a class="with-down-arrow">
          Learn
        </a>
        <div class="resources-dropdown-menu">
          <a class="nav-dropdown-item" href="/get-started">
            <span class=dropdown-title>Get Started</span>
            <p>Run PyTorch locally or get started quickly with one of the supported cloud platforms</p>
          </a>
          <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/">
            <span class="dropdown-title">Tutorials</span>
            <p>Whats new in PyTorch tutorials</p>
          </a>
          <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/basics/intro.html">
            <span class="dropdown-title">Learn the Basics</span>
            <p>Familiarize yourself with PyTorch concepts and modules</p>
          </a>
          <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/recipes/recipes_index.html">
            <span class="dropdown-title">PyTorch Recipes</span>
            <p>Bite-size, ready-to-deploy PyTorch code examples</p>
          </a>
          <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/introyt.html">
            <span class="dropdown-title">Intro to PyTorch - YouTube Series</span>
            <p>Master PyTorch basics with our engaging YouTube tutorial series</p>
          </a>
        </div>
      </div>
    </li>

    <li class="main-menu-item">
      <div id="dropdownMenuButton" data-toggle="resources-dropdown" class="resources-dropdown">
        <a class="with-down-arrow">
          Ecosystem 
        </a>
        <div class="resources-dropdown-menu">
          <a class="nav-dropdown-item" href="/ecosystem">
            <span class="dropdown-title">Tools</span>
            <p>Learn about the tools and frameworks in the PyTorch Ecosystem</p>
          </a>
          <a class="nav-dropdown-item" href="/#community-module">
            <span class=dropdown-title>Community</span>
            <p>Join the PyTorch developer community to contribute, learn, and get your questions answered.</p>
          </a>
          <a class="nav-dropdown-item" href="https://discuss.pytorch.org" target="_blank">
            <span class=dropdown-title>Forums</span>
            <p>A place to discuss PyTorch code, issues, install, research</p>
          </a>
          <a class="nav-dropdown-item" href="/resources">
            <span class=dropdown-title>Developer Resources</span>
            <p>Find resources and get questions answered</p>
          </a>
          <a class="nav-dropdown-item" href="/ecosystem/contributor-awards-2023">
            <span class="dropdown-title">Contributor Awards - 2023</span>
            <p>Award winners announced at this year's PyTorch Conference</p>
          </a>
        </div>
      </div>
    </li>

    <li class="main-menu-item">
      <div id="dropdownMenuButton" data-toggle="resources-dropdown" class="resources-dropdown">
        <a class="with-down-arrow">
          Edge 
        </a>
        <div class="resources-dropdown-menu">
          <a class="nav-dropdown-item" href="/edge">
            <span class="dropdown-title">About PyTorch Edge</span>
            <p>Build innovative and privacy-aware AI experiences for edge devices</p>
          </a>
          <a class="nav-dropdown-item" href="/executorch-overview">
            <span class="dropdown-title">ExecuTorch</span>
            <p>End-to-end solution for enabling on-device inference capabilities across mobile and edge devices</p>
          </a>
        </div>
      </div>
    </li>

    <li class="main-menu-item">
      <div id="docsDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
        <a class="with-down-arrow">
          Docs
        </a>
        <div class="resources-dropdown-menu">
          <a class="nav-dropdown-item" href="https://pytorch.org/docs">
            <span class="dropdown-title">PyTorch</span>
            <p>Explore the documentation for comprehensive guidance on how to use PyTorch.</p>
          </a>
          <a class="nav-dropdown-item" href="/pytorch-domains">
            <span class="dropdown-title">PyTorch Domains</span>
            <p> Read the PyTorch Domains documentation to learn more about domain-specific libraries.</p>
          </a>
        </div>
      </div>
    </li>

    <li class="main-menu-item">
      <div id="dropdownMenuButton" data-toggle="resources-dropdown" class="resources-dropdown">
        <a class="with-down-arrow">
          Blog & News
        </a>
        <div class="resources-dropdown-menu">
          <a class="nav-dropdown-item" href="/blog">
            <span class="dropdown-title">PyTorch Blog</span>
            <p>Catch up on the latest technical news and happenings</p>
          </a>
          <a class="nav-dropdown-item" href="/community-blog">
            <span class="dropdown-title">Community Blog</span>
            <p>Stories from the PyTorch ecosystem</p>
          </a>
          <a class="nav-dropdown-item" href="/videos">
            <span class="dropdown-title">Videos</span>
            <p>Learn about the latest PyTorch tutorials, new, and more </p>
          </a>
          <a class="nav-dropdown-item" href="/community-stories">
            <span class="dropdown-title">Community Stories</span>
            <p>Learn how our community solves real, everyday machine learning problems with PyTorch</p>
          </a>
          <a class="nav-dropdown-item" href="/events">
            <span class=dropdown-title>Events</span>
            <p>Find events, webinars, and podcasts</p>
          </a>
        </div>
      </div>
    </li>

    <li class="main-menu-item">
      <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
        <a class="with-down-arrow">
          About
        </a>
        <div class="resources-dropdown-menu">
          <a class="nav-dropdown-item" href="/foundation">
            <span class=dropdown-title>PyTorch Foundation</span>
            <p>Learn more about the PyTorch Foundation.</p>
          </a>
          <a class="nav-dropdown-item" href="/governing-board">
            <span class=dropdown-title>Governing Board</span>
          </a>
        </div>
      </div>
    </li>

    <li class="main-menu-item">
      <a href="/join" data-cta="join">
        Become a Member
      </a>
    </li>

    <li class="main-menu-item" id="github-main-menu-link">
      <a href="https://github.com/pytorch/pytorch" title="Go to PyTorch GitHub">
        <div id="topnav-gh-icon"></div>
      </a>
    </li>

    <li class="navSearchWrapper reactNavSearchWrapper" key="search">
      <div class="search-border">
        <div id="search-icon"></div>
        <input
          id="search-input"
          type="text"
          title="Search"
        />
        <div id="close-search">X</div>
      </div>
    </li>
  </ul>
</div>

<script src="/assets/main-menu-dropdown.js"></script>


  <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
</div>

        </div>
    </div>

    <div class="jumbotron jumbotron-fluid blog-detail-jumbotron">
        <div class="container blog-detail-container">
            <p class="featured-post">October 27, 2020</p>
            <h1>
                <a class="blog-title">PyTorch 1.7 released w/ CUDA 11, New APIs for FFTs, Windows support for Distributed training and more</a>
            </h1>
        </div>
    </div>

    <div class="main-content-wrapper blog-detail-wrapper">
        <div class="main-content blog-detail-content">
            <div class="container">
                <img src="/assets/images/logo-icon.svg" class="img-fluid author-icon">
                <article class="pytorch-article">
                    <p class="author">
                      by
                      
                        Team PyTorch
                      
                    </p>
                    <p>Today, we’re announcing the availability of PyTorch 1.7, along with updated domain libraries. The PyTorch 1.7 release includes a number of new APIs including support for NumPy-Compatible FFT operations, profiling tools and major updates to both distributed data parallel (DDP) and remote procedure call (RPC) based distributed training. In addition, several features moved to <a href="https://pytorch.org/docs/stable/index.html#pytorch-documentation">stable</a> including custom C++ Classes, the memory profiler, extensions via custom tensor-like objects, user async functions in RPC and a number of other features in torch.distributed such as Per-RPC timeout, DDP dynamic bucketing and RRef helper.</p>

<p>A few of the highlights include:</p>
<ul>
  <li>CUDA 11 is now officially supported with binaries available at <a href="http://pytorch.org/">PyTorch.org</a></li>
  <li>Updates and additions to profiling and performance for RPC, TorchScript and Stack traces in the autograd profiler</li>
  <li>(Beta) Support for NumPy compatible Fast Fourier transforms (FFT) via torch.fft</li>
  <li>(Prototype) Support for Nvidia A100 generation GPUs and native TF32 format</li>
  <li>(Prototype) Distributed training on Windows now supported</li>
  <li>torchvision
    <ul>
      <li>(Stable) Transforms now support Tensor inputs, batch computation, GPU, and TorchScript</li>
      <li>(Stable) Native image I/O for JPEG and PNG formats</li>
      <li>(Beta) New Video Reader API</li>
    </ul>
  </li>
  <li>torchaudio
    <ul>
      <li>(Stable) Added support for speech rec (wav2letter), text to speech (WaveRNN) and source separation (ConvTasNet)</li>
    </ul>
  </li>
</ul>

<p>To reiterate, starting PyTorch 1.6, features are now classified as stable, beta and prototype. You can see the detailed announcement <a href="https://pytorch.org/blog/pytorch-feature-classification-changes/">here</a>. Note that the prototype features listed in this blog are available as part of this release.</p>

<p>Find the full release notes <a href="https://github.com/pytorch/pytorch/releases">here</a>.</p>

<h1 id="front-end-apis">Front End APIs</h1>
<h2 id="beta-numpy-compatible-torchfft-module">[Beta] NumPy Compatible torch.fft module</h2>
<p>FFT-related functionality is commonly used in a variety of scientific fields like signal processing. While PyTorch has historically supported a few FFT-related functions, the 1.7 release adds a new torch.fft module that implements FFT-related functions with the same API as NumPy.</p>

<p>This new module must be imported to be used in the 1.7 release, since its name conflicts with the historic (and now deprecated) torch.fft function.</p>

<p><strong>Example usage:</strong></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">torch.fft</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span>
<span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">torch</span><span class="p">.</span><span class="n">fft</span><span class="p">.</span><span class="n">fft</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">([</span> <span class="mf">6.</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="o">+</span><span class="mf">2.j</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="o">-</span><span class="mf">2.j</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.</span><span class="o">+</span><span class="mf">1.j</span><span class="p">,</span> <span class="mf">2.</span><span class="o">+</span><span class="mf">3.j</span><span class="p">,</span> <span class="mf">4.</span><span class="o">+</span><span class="mf">5.j</span><span class="p">,</span> <span class="mf">6.</span><span class="o">+</span><span class="mf">7.j</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">torch</span><span class="p">.</span><span class="n">fft</span><span class="p">.</span><span class="n">fft</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">([</span><span class="mf">12.</span><span class="o">+</span><span class="mf">16.j</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.</span><span class="o">-</span><span class="mf">4.j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">-</span><span class="mf">8.j</span><span class="p">])</span>
</code></pre></div></div>

<ul>
  <li><a href="https://pytorch.org/docs/stable/fft.html#torch-fft">Documentation</a></li>
</ul>

<h2 id="beta-c-support-for-transformer-nn-modules">[Beta] C++ Support for Transformer NN Modules</h2>
<p>Since <a href="https://pytorch.org/blog/pytorch-1-dot-5-released-with-new-and-updated-apis/">PyTorch 1.5</a>, we’ve continued to maintain parity between the python and C++ frontend APIs. This update allows developers to use the nn.transformer module abstraction from the C++ Frontend. And moreover, developers no longer need to save a module from python/JIT and load into C++ as it can now be used it in C++ directly.</p>
<ul>
  <li><a href="https://pytorch.org/cppdocs/api/classtorch_1_1nn_1_1_transformer_impl.html#_CPPv4N5torch2nn15TransformerImplE">Documentation</a></li>
</ul>

<h2 id="beta-torchset_deterministic">[Beta] torch.set_deterministic</h2>
<p>Reproducibility (bit-for-bit determinism) may help identify errors when debugging or testing a program. To facilitate reproducibility, PyTorch 1.7 adds the  <code class="language-plaintext highlighter-rouge">torch.set_deterministic(bool)</code> function that can direct PyTorch operators to select deterministic algorithms when available, and to throw a runtime error if an operation may result in nondeterministic behavior. By default, the flag this function controls is false and there is no change in behavior, meaning PyTorch may implement its operations nondeterministically by default.</p>

<p>More precisely, when this flag is true:</p>
<ul>
  <li>Operations known to not have a deterministic implementation throw a runtime error;</li>
  <li>Operations with deterministic variants use those variants (usually with a performance penalty versus the non-deterministic version); and</li>
  <li><code class="language-plaintext highlighter-rouge">torch.backends.cudnn.deterministic = True</code> is set.</li>
</ul>

<p>Note that this is necessary, <strong>but not sufficient</strong>, for determinism <strong>within a single run of a PyTorch program</strong>. Other sources of randomness like random number generators, unknown operations, or asynchronous or distributed computation may still cause nondeterministic behavior.</p>

<p>See the documentation for <code class="language-plaintext highlighter-rouge">torch.set_deterministic(bool)</code> for the list of affected operations.</p>
<ul>
  <li><a href="https://github.com/pytorch/pytorch/issues/15359">RFC</a></li>
</ul>

<h1 id="performance--profiling">Performance &amp; Profiling</h1>
<h2 id="beta-stack-traces-added-to-profiler">[Beta] Stack traces added to profiler</h2>
<p>Users can now see not only operator name/inputs in the profiler output table but also where the operator is in the code. The workflow requires very little change to take advantage of this capability. The user uses the <a href="https://pytorch.org/docs/stable/autograd.html#profiler">autograd profiler</a> as before but with optional new parameters: <code class="language-plaintext highlighter-rouge">with_stack</code> and <code class="language-plaintext highlighter-rouge">group_by_stack_n</code>. Caution: regular profiling runs should not use this feature as it adds significant overhead.</p>
<ul>
  <li><a href="https://github.com/pytorch/pytorch/pull/43898/">Detail</a></li>
  <li><a href="https://pytorch.org/docs/stable/autograd.html">Documentation</a></li>
</ul>

<h1 id="distributed-training--rpc">Distributed Training &amp; RPC</h1>
<h2 id="stable-torchelastic-now-bundled-into-pytorch-docker-image">[Stable] TorchElastic now bundled into PyTorch docker image</h2>
<p>Torchelastic offers a strict superset of the current <code class="language-plaintext highlighter-rouge">torch.distributed.launch</code> CLI with the added features for fault-tolerance and elasticity. If the user is not be interested in fault-tolerance, they can get the exact functionality/behavior parity by setting <code class="language-plaintext highlighter-rouge">max_restarts=0</code> with the added convenience of auto-assigned <code class="language-plaintext highlighter-rouge">RANK</code> and <code class="language-plaintext highlighter-rouge">MASTER_ADDR|PORT</code> (versus manually specified in <code class="language-plaintext highlighter-rouge">torch.distributed.launch)</code>.</p>

<p>By bundling <code class="language-plaintext highlighter-rouge">torchelastic</code> in the same docker image as PyTorch, users can start experimenting with TorchElastic right-away without having to separately install <code class="language-plaintext highlighter-rouge">torchelastic</code>. In addition to convenience, this work is a nice-to-have when adding support for elastic parameters in the existing Kubeflow’s distributed PyTorch operators.</p>
<ul>
  <li><a href="https://pytorch.org/elastic/0.2.0/examples.html">Usage examples and how to get started</a></li>
</ul>

<h2 id="beta-support-for-uneven-dataset-inputs-in-ddp">[Beta] Support for uneven dataset inputs in DDP</h2>
<p>PyTorch 1.7 introduces a new context manager to be used in conjunction with models trained using <code class="language-plaintext highlighter-rouge">torch.nn.parallel.DistributedDataParallel</code> to enable training with uneven dataset size across different processes. This feature enables greater flexibility when using DDP and prevents the user from having to manually ensure dataset sizes are the same across different process. With this context manager, DDP will handle uneven dataset sizes automatically, which can prevent errors or hangs at the end of training.</p>
<ul>
  <li><a href="https://github.com/pytorch/pytorch/issues/38174">RFC</a></li>
  <li><a href="https://pytorch.org/docs/stable/generated/torch.nn.parallel.DistributedDataParallel.html#torch.nn.parallel.DistributedDataParallel.join">Documentation</a></li>
</ul>

<h2 id="beta-nccl-reliability---async-errortimeout-handling">[Beta] NCCL Reliability - Async Error/Timeout Handling</h2>
<p>In the past, NCCL training runs would hang indefinitely due to stuck collectives, leading to a very unpleasant experience for users. This feature will abort stuck collectives and throw an exception/crash the process if a potential hang is detected. When used with something like torchelastic (which can recover the training process from the last checkpoint), users can have much greater reliability for distributed training. This feature is completely opt-in and sits behind an environment variable that needs to be explicitly set in order to enable this functionality (otherwise users will see the same behavior as before).</p>
<ul>
  <li><a href="https://github.com/pytorch/pytorch/issues/46874">RFC</a></li>
  <li><a href="https://pytorch.org/docs/stable/distributed.html?highlight=init_process_group#torch.distributed.init_process_group">Documentation</a></li>
</ul>

<h2 id="beta-torchscript-rpc_remote-and-rpc_sync">[Beta] TorchScript <code class="language-plaintext highlighter-rouge">rpc_remote</code> and <code class="language-plaintext highlighter-rouge">rpc_sync</code></h2>
<p><code class="language-plaintext highlighter-rouge">torch.distributed.rpc.rpc_async</code> has been available in TorchScript in prior releases. For PyTorch 1.7, this functionality will be extended the remaining two core RPC APIs, <code class="language-plaintext highlighter-rouge">torch.distributed.rpc.rpc_sync</code> and <code class="language-plaintext highlighter-rouge">torch.distributed.rpc.remote</code>. This will complete the major RPC APIs targeted for support in TorchScript, it allows users to use the existing python RPC APIs within TorchScript (in a script function or script method, which releases the python Global Interpreter Lock) and could possibly improve application performance in multithreaded environment.</p>
<ul>
  <li><a href="https://pytorch.org/docs/stable/rpc.html#rpc">Documentation</a></li>
  <li><a href="https://github.com/pytorch/pytorch/blob/58ed60c259834e324e86f3e3118e4fcbbfea8dd1/torch/testing/_internal/distributed/rpc/jit/rpc_test.py#L505-L525">Usage examples</a></li>
</ul>

<h2 id="beta-distributed-optimizer-with-torchscript-support">[Beta] Distributed optimizer with TorchScript support</h2>
<p>PyTorch provides a broad set of optimizers for training algorithms, and these have been used repeatedly as part of the python API. However, users often want to use multithreaded training instead of multiprocess training as it provides better resource utilization and efficiency in the context of large scale distributed training (e.g. Distributed Model Parallel) or any RPC-based training application). Users couldn’t do this with with distributed optimizer before because we need to get rid of the python Global Interpreter Lock (GIL) limitation to achieve this.</p>

<p>In PyTorch 1.7, we are enabling the TorchScript support in distributed optimizer to remove the GIL, and make it possible to run optimizer in multithreaded applications. The new distributed optimizer has the exact same interface as before but it automatically converts optimizers within each worker into TorchScript to make each GIL free. This is done by leveraging a functional optimizer concept and allowing the distributed optimizer to convert the computational portion of the optimizer into TorchScript. This will help use cases like distributed model parallel training and improve performance using multithreading.</p>

<p>Currently, the only optimizer that supports automatic conversion with TorchScript is <code class="language-plaintext highlighter-rouge">Adagrad</code> and all other optimizers will still work as before without TorchScript support. We are working on expanding the coverage to all PyTorch optimizers and expect more to come in future releases. The usage to enable TorchScript support is automatic and exactly the same with existing python APIs, here is an example of how to use this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch.distributed.autograd</span> <span class="k">as</span> <span class="n">dist_autograd</span>
<span class="kn">import</span> <span class="nn">torch.distributed.rpc</span> <span class="k">as</span> <span class="n">rpc</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">optim</span>
<span class="kn">from</span> <span class="nn">torch.distributed.optim</span> <span class="kn">import</span> <span class="n">DistributedOptimizer</span>

<span class="k">with</span> <span class="n">dist_autograd</span><span class="p">.</span><span class="n">context</span><span class="p">()</span> <span class="k">as</span> <span class="n">context_id</span><span class="p">:</span>
  <span class="c1"># Forward pass.
</span>  <span class="n">rref1</span> <span class="o">=</span> <span class="n">rpc</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="s">"worker1"</span><span class="p">,</span> <span class="n">torch</span><span class="p">.</span><span class="n">add</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
  <span class="n">rref2</span> <span class="o">=</span> <span class="n">rpc</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="s">"worker1"</span><span class="p">,</span> <span class="n">torch</span><span class="p">.</span><span class="n">add</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">loss</span> <span class="o">=</span> <span class="n">rref1</span><span class="p">.</span><span class="n">to_here</span><span class="p">()</span> <span class="o">+</span> <span class="n">rref2</span><span class="p">.</span><span class="n">to_here</span><span class="p">()</span>

  <span class="c1"># Backward pass.
</span>  <span class="n">dist_autograd</span><span class="p">.</span><span class="n">backward</span><span class="p">(</span><span class="n">context_id</span><span class="p">,</span> <span class="p">[</span><span class="n">loss</span><span class="p">.</span><span class="nb">sum</span><span class="p">()])</span>

  <span class="c1"># Optimizer, pass in optim.Adagrad, DistributedOptimizer will
</span>  <span class="c1"># automatically convert/compile it to TorchScript (GIL-free)
</span>  <span class="n">dist_optim</span> <span class="o">=</span> <span class="n">DistributedOptimizer</span><span class="p">(</span>
     <span class="n">optim</span><span class="p">.</span><span class="n">Adagrad</span><span class="p">,</span>
     <span class="p">[</span><span class="n">rref1</span><span class="p">,</span> <span class="n">rref2</span><span class="p">],</span>
     <span class="n">lr</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
  <span class="p">)</span>
  <span class="n">dist_optim</span><span class="p">.</span><span class="n">step</span><span class="p">(</span><span class="n">context_id</span><span class="p">)</span>
</code></pre></div></div>
<ul>
  <li><a href="https://github.com/pytorch/pytorch/issues/46883">RFC</a></li>
  <li><a href="https://pytorch.org/docs/stable/rpc.html#module-torch.distributed.optim">Documentation</a></li>
</ul>

<h2 id="beta-enhancements-to-rpc-based-profiling">[Beta] Enhancements to RPC-based Profiling</h2>
<p>Support for using the PyTorch profiler in conjunction with the RPC framework was first introduced in PyTorch 1.6. In PyTorch 1.7, the following enhancements have been made:</p>
<ul>
  <li>Implemented better support for profiling TorchScript functions over RPC</li>
  <li>Achieved parity in terms of profiler features that work with RPC</li>
  <li>Added support for asynchronous RPC functions on the server-side (functions decorated with <code class="language-plaintext highlighter-rouge">rpc.functions.async_execution)</code>.</li>
</ul>

<p>Users are now able to use familiar profiling tools such as with <code class="language-plaintext highlighter-rouge">torch.autograd.profiler.profile()</code> and <code class="language-plaintext highlighter-rouge">with torch.autograd.profiler.record_function</code>, and this works transparently with the RPC framework with full feature support, profiles asynchronous functions, and TorchScript functions.</p>
<ul>
  <li><a href="https://github.com/pytorch/pytorch/issues/39675">Design doc</a></li>
  <li><a href="https://pytorch.org/tutorials/recipes/distributed_rpc_profiling.html">Usage examples</a></li>
</ul>

<h2 id="prototype-windows-support-for-distributed-training">[Prototype] Windows support for Distributed Training</h2>
<p>PyTorch 1.7 brings prototype support for <code class="language-plaintext highlighter-rouge">DistributedDataParallel</code> and collective communications on the Windows platform. In this release, the support only covers Gloo-based <code class="language-plaintext highlighter-rouge">ProcessGroup</code> and <code class="language-plaintext highlighter-rouge">FileStore</code>.</p>

<p>To use this feature across multiple machines, please provide a file from a shared file system in <code class="language-plaintext highlighter-rouge">init_process_group</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># initialize the process group
</span><span class="n">dist</span><span class="p">.</span><span class="n">init_process_group</span><span class="p">(</span>
    <span class="s">"gloo"</span><span class="p">,</span>
    <span class="c1"># multi-machine example:
</span>    <span class="c1"># init_method = "file://////{machine}/{share_folder}/file"
</span>    <span class="n">init_method</span><span class="o">=</span><span class="s">"file:///{your local file path}"</span><span class="p">,</span>
    <span class="n">rank</span><span class="o">=</span><span class="n">rank</span><span class="p">,</span>
    <span class="n">world_size</span><span class="o">=</span><span class="n">world_size</span>
<span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DistributedDataParallel</span><span class="p">(</span><span class="n">local_model</span><span class="p">,</span> <span class="n">device_ids</span><span class="o">=</span><span class="p">[</span><span class="n">rank</span><span class="p">])</span>
</code></pre></div></div>
<ul>
  <li><a href="https://github.com/pytorch/pytorch/issues/42095">Design doc</a></li>
  <li><a href="https://pytorch.org/docs/master/distributed.html#backends-that-come-with-pytorch">Documentation</a></li>
  <li>Acknowledgement (<a href="https://github.com/gunandrose4u">gunandrose4u</a>)</li>
</ul>

<h1 id="mobile">Mobile</h1>
<p>PyTorch Mobile supports both <a href="https://pytorch.org/mobile/ios">iOS</a> and <a href="https://pytorch.org/mobile/android/">Android</a> with binary packages available in <a href="https://cocoapods.org/">Cocoapods</a> and <a href="https://mvnrepository.com/repos/jcenter">JCenter</a> respectively. You can learn more about PyTorch Mobile <a href="https://pytorch.org/mobile/home/">here</a>.</p>

<h2 id="beta-pytorch-mobile-caching-allocator-for-performance-improvements">[Beta] PyTorch Mobile Caching allocator for performance improvements</h2>
<p>On some mobile platforms, such as Pixel, we observed that memory is returned to the system more aggressively. This results in frequent page faults as PyTorch being a functional framework does not maintain state for the operators. Thus outputs are allocated dynamically on each execution of the op, for the most ops. To ameliorate performance penalties due to this, PyTorch 1.7 provides a simple caching allocator for CPU. The allocator caches allocations by tensor sizes and, is currently, available only via the PyTorch C++ API. The caching allocator itself is owned by client and thus the lifetime of the allocator is also maintained by client code. Such a client owned caching allocator can then be used with scoped guard, <code class="language-plaintext highlighter-rouge">c10::WithCPUCachingAllocatorGuard</code>, to enable the use of cached allocation within that scope.
<strong>Example usage:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#include &lt;c10/mobile/CPUCachingAllocator.h&gt;
</span><span class="p">.....</span>
<span class="n">c10</span><span class="p">::</span><span class="n">CPUCachingAllocator</span> <span class="n">caching_allocator</span><span class="p">;</span>
  <span class="o">//</span> <span class="n">Owned</span> <span class="n">by</span> <span class="n">client</span> <span class="n">code</span><span class="p">.</span> <span class="n">Can</span> <span class="n">be</span> <span class="n">a</span> <span class="n">member</span> <span class="n">of</span> <span class="n">some</span> <span class="n">client</span> <span class="k">class</span> <span class="nc">so</span> <span class="k">as</span> <span class="n">to</span> <span class="n">tie</span> <span class="n">the</span>
  <span class="o">//</span> <span class="n">the</span> <span class="n">lifetime</span> <span class="n">of</span> <span class="n">caching</span> <span class="n">allocator</span> <span class="n">to</span> <span class="n">that</span> <span class="n">of</span> <span class="n">the</span> <span class="n">class</span><span class="p">.</span>
<span class="p">.....</span>
<span class="p">{</span>
  <span class="n">c10</span><span class="p">::</span><span class="n">optional</span><span class="o">&lt;</span><span class="n">c10</span><span class="p">::</span><span class="n">WithCPUCachingAllocatorGuard</span><span class="o">&gt;</span> <span class="n">caching_allocator_guard</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">FLAGS_use_caching_allocator</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">caching_allocator_guard</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="o">&amp;</span><span class="n">caching_allocator</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="p">....</span>
  <span class="n">model</span><span class="p">.</span><span class="n">forward</span><span class="p">(..);</span>
<span class="p">}</span>
<span class="p">...</span>
</code></pre></div></div>
<p><strong>NOTE</strong>: Caching allocator is only available on mobile builds, thus the use of caching allocator outside of mobile builds won’t be effective.</p>
<ul>
  <li><a href="https://github.com/pytorch/pytorch/blob/master/c10/mobile/CPUCachingAllocator.h#L13-L43">Documentation</a></li>
  <li><a href="https://github.com/pytorch/pytorch/blob/master/binaries/speed_benchmark_torch.cc#L207">Usage examples</a></li>
</ul>

<h1 id="torchvision">torchvision</h1>
<h2 id="stable-transforms-now-support-tensor-inputs-batch-computation-gpu-and-torchscript">[Stable] Transforms now support Tensor inputs, batch computation, GPU, and TorchScript</h2>
<p>torchvision transforms are now inherited from <code class="language-plaintext highlighter-rouge">nn.Module</code> and can be torchscripted and applied on torch Tensor inputs as well as on PIL images. They also support Tensors with batch dimensions and work seamlessly on CPU/GPU devices:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="n">T</span>

<span class="c1"># to fix random seed, use torch.manual_seed
# instead of random.seed
</span><span class="n">torch</span><span class="p">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="n">transforms</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">T</span><span class="p">.</span><span class="n">RandomCrop</span><span class="p">(</span><span class="mi">224</span><span class="p">),</span>
    <span class="n">T</span><span class="p">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.3</span><span class="p">),</span>
    <span class="n">T</span><span class="p">.</span><span class="n">ConvertImageDtype</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="nb">float</span><span class="p">),</span>
    <span class="n">T</span><span class="p">.</span><span class="n">Normalize</span><span class="p">([</span><span class="mf">0.485</span><span class="p">,</span> <span class="mf">0.456</span><span class="p">,</span> <span class="mf">0.406</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.229</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">])</span>
<span class="p">)</span>
<span class="n">scripted_transforms</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">jit</span><span class="p">.</span><span class="n">script</span><span class="p">(</span><span class="n">transforms</span><span class="p">)</span>
<span class="c1"># Note: we can similarly use T.Compose to define transforms
# transforms = T.Compose([...]) and 
# scripted_transforms = torch.jit.script(torch.nn.Sequential(*transforms.transforms))
</span>
<span class="n">tensor_image</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="c1"># works directly on Tensors
</span><span class="n">out_image1</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">(</span><span class="n">tensor_image</span><span class="p">)</span>
<span class="c1"># on the GPU
</span><span class="n">out_image1_cuda</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">(</span><span class="n">tensor_image</span><span class="p">.</span><span class="n">cuda</span><span class="p">())</span>
<span class="c1"># with batches
</span><span class="n">batched_image</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">out_image_batched</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">(</span><span class="n">batched_image</span><span class="p">)</span>
<span class="c1"># and has torchscript support
</span><span class="n">out_image2</span> <span class="o">=</span> <span class="n">scripted_transforms</span><span class="p">(</span><span class="n">tensor_image</span><span class="p">)</span>
</code></pre></div></div>
<p>These improvements enable the following new features:</p>
<ul>
  <li>support for GPU acceleration</li>
  <li>batched transformations e.g. as needed for videos</li>
  <li>transform multi-band torch tensor images (with more than 3-4 channels)</li>
  <li>torchscript transforms together with your model for deployment
<strong>Note:</strong> Exceptions for TorchScript support includes <code class="language-plaintext highlighter-rouge">Compose</code>, <code class="language-plaintext highlighter-rouge">RandomChoice</code>, <code class="language-plaintext highlighter-rouge">RandomOrder</code>, <code class="language-plaintext highlighter-rouge">Lambda</code> and those applied on PIL images, such as <code class="language-plaintext highlighter-rouge">ToPILImage</code>.</li>
</ul>

<h2 id="stable-native-image-io-for-jpeg-and-png-formats">[Stable] Native image IO for JPEG and PNG formats</h2>
<p>torchvision 0.8.0 introduces native image reading and writing operations for JPEG and PNG formats. Those operators support TorchScript and return <code class="language-plaintext highlighter-rouge">CxHxW</code> tensors in <code class="language-plaintext highlighter-rouge">uint8</code> format, and can thus be now part of your model for deployment in C++ environments.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">torchvision.io</span> <span class="kn">import</span> <span class="n">read_image</span>

<span class="c1"># tensor_image is a CxHxW uint8 Tensor
</span><span class="n">tensor_image</span> <span class="o">=</span> <span class="n">read_image</span><span class="p">(</span><span class="s">'path_to_image.jpeg'</span><span class="p">)</span>

<span class="c1"># or equivalently
</span><span class="kn">from</span> <span class="nn">torchvision.io</span> <span class="kn">import</span> <span class="n">read_file</span><span class="p">,</span> <span class="n">decode_image</span>
<span class="c1"># raw_data is a 1d uint8 Tensor with the raw bytes
</span><span class="n">raw_data</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="s">'path_to_image.jpeg'</span><span class="p">)</span>
<span class="n">tensor_image</span> <span class="o">=</span> <span class="n">decode_image</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

<span class="c1"># all operators are torchscriptable and can be
# serialized together with your model torchscript code
</span><span class="n">scripted_read_image</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">jit</span><span class="p">.</span><span class="n">script</span><span class="p">(</span><span class="n">read_image</span><span class="p">)</span>
</code></pre></div></div>
<h2 id="stable-retinanet-detection-model">[Stable] RetinaNet detection model</h2>
<p>This release adds pretrained models for RetinaNet with a ResNet50 backbone from <a href="https://arxiv.org/abs/1708.02002">Focal Loss for Dense Object Detection</a>.</p>

<h2 id="beta-new-video-reader-api">[Beta] New Video Reader API</h2>
<p>This release introduces a new video reading abstraction, which gives more fine-grained control of iteration over videos. It supports image and audio, and implements an iterator interface so that it is interoperable with other the python libraries such as itertools.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">torchvision.io</span> <span class="kn">import</span> <span class="n">VideoReader</span>

<span class="c1"># stream indicates if reading from audio or video
</span><span class="n">reader</span> <span class="o">=</span> <span class="n">VideoReader</span><span class="p">(</span><span class="s">'path_to_video.mp4'</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="s">'video'</span><span class="p">)</span>
<span class="c1"># can change the stream after construction
# via reader.set_current_stream
</span>
<span class="c1"># to read all frames in a video starting at 2 seconds
</span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="c1"># frame is a dict with "data" and "pts" metadata
</span>    <span class="k">print</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="s">"data"</span><span class="p">],</span> <span class="n">frame</span><span class="p">[</span><span class="s">"pts"</span><span class="p">])</span>

<span class="c1"># because reader is an iterator you can combine it with
# itertools
</span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">takewhile</span><span class="p">,</span> <span class="n">islice</span>
<span class="c1"># read 10 frames starting from 2 seconds
</span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">islice</span><span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">10</span><span class="p">):</span>
    <span class="k">pass</span>
    
<span class="c1"># or to return all frames between 2 and 5 seconds
</span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">takewhile</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s">"pts"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span> <span class="n">reader</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></div>
<p><strong>Notes:</strong></p>
<ul>
  <li>In order to use the Video Reader API beta, you must compile torchvision from source and have ffmpeg installed in your system.</li>
  <li>The VideoReader API is currently released as beta and its API may change following user feedback.</li>
</ul>

<h1 id="torchaudio">torchaudio</h1>
<p>With this release, torchaudio is expanding its support for models and <a href="https://github.com/pytorch/audio/tree/master/examples">end-to-end applications</a>, adding a wav2letter training pipeline and end-to-end text-to-speech and source separation pipelines. Please file an issue on <a href="https://github.com/pytorch/audio/issues/new?template=questions-help-support.md">github</a> to provide feedback on them.</p>

<h2 id="stable-speech-recognition">[Stable] Speech Recognition</h2>
<p>Building on the addition of the wav2letter model for speech recognition in the last release, we’ve now added an <a href="https://github.com/pytorch/audio/tree/master/examples/pipeline_wav2letter">example wav2letter training pipeline</a> with the LibriSpeech dataset.</p>

<h2 id="stable-text-to-speech">[Stable] Text-to-speech</h2>
<p>With the goal of supporting text-to-speech applications, we added a vocoder based on the WaveRNN model, based on the implementation from <a href="https://github.com/fatchord/WaveRNN">this repository</a>. The original implementation was introduced in “Efficient Neural Audio Synthesis”. We also provide an <a href="https://github.com/pytorch/audio/tree/master/examples/pipeline_wavernn">example WaveRNN training pipeline</a> that uses the LibriTTS dataset added to torchaudio in this release.</p>

<h2 id="stable-source-separation">[Stable] Source Separation</h2>
<p>With the addition of the ConvTasNet model, based on the paper “Conv-TasNet: Surpassing Ideal Time-Frequency Magnitude Masking for Speech Separation,” torchaudio now also supports source separation. An <a href="https://github.com/pytorch/audio/tree/master/examples/source_separation">example ConvTasNet training pipeline</a> is provided with the wsj-mix dataset.</p>

<p>Cheers!</p>

<p>Team PyTorch</p>

                </article>
            </div>
        </div>
    </div>

<!--    


 -->
    <div class="container-fluid docs-tutorials-resources">
  <div class="container">
    <div class="row">
      <div class="col-md-4 text-center">
        <h2>Docs</h2>
        <p>Access comprehensive developer documentation for PyTorch</p>
        <a class="with-right-arrow" href="/docs">View Docs</a>
      </div>

      <div class="col-md-4 text-center">
        <h2>Tutorials</h2>
        <p>Get in-depth tutorials for beginners and advanced developers</p>
        <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
      </div>

      <div class="col-md-4 text-center">
        <h2>Resources</h2>
        <p>Find development resources and get your questions answered</p>
        <a class="with-right-arrow" href="/resources">View Resources</a>
      </div>
    </div>
  </div>
</div>

<footer class="site-footer">
  <div class="container footer-container">
    <div class="lf-grid">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org" class="footer-logo">
          <img src="/assets/images/logo-icon.svg" alt="PyTorch logo" width="40">
        </a>
      </div>

      <ul class="social-links">
        <li><a href="https://www.facebook.com/pytorch" target="_blank" title="PyTorch on Facebook">
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="-0.51 -0.26 26.45 26.45" aria-label="Facebook"><path fill="currentColor" d="M25.497 13.075c0-2.45-.698-4.848-2.011-6.911a12.765 12.765 0 0 0-5.398-4.73A12.671 12.671 0 0 0 11.008.38a12.705 12.705 0 0 0-6.529 2.95A12.827 12.827 0 0 0 .563 9.358a12.896 12.896 0 0 0-.07 7.201 12.831 12.831 0 0 0 3.801 6.103 12.709 12.709 0 0 0 6.471 3.078v-8.957H7.53v-3.708h3.235v-2.824c0-3.213 1.903-4.988 4.813-4.988.956.014 1.909.097 2.852.25V8.67h-1.607a1.83 1.83 0 0 0-1.518.497 1.854 1.854 0 0 0-.561 1.505v2.404h3.535l-.563 3.708h-2.97v8.957a12.725 12.725 0 0 0 7.697-4.337 12.87 12.87 0 0 0 3.054-8.328z"/></svg>	
        </a></li>
        <li><a href="https://twitter.com/pytorch" target="_blank" title="PyTorch on X">
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 300 300" aria-label="X"><path fill="currentColor" d="M178.57 127.15 290.27 0h-26.46l-97.03 110.38L89.34 0H0l117.13 166.93L0 300.25h26.46l102.4-116.59 81.8 116.59h89.34M36.01 19.54H76.66l187.13 262.13h-40.66"/></svg>
        </a></li>
        <li><a href="https://www.youtube.com/pytorch" target="_blank" title="PyTorch on YouTube">
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="0.21 0.27 34.45 25.07" aria-label="YouTube"><path fill="currentColor" d="M33.729 6.084s-.327-2.33-1.317-3.356a4.691 4.691 0 0 0-3.32-1.432c-4.634-.34-11.589-.34-11.589-.34h-.014s-6.954 0-11.59.342a4.692 4.692 0 0 0-3.32 1.432c-.993 1.025-1.315 3.354-1.315 3.354a52.189 52.189 0 0 0-.331 5.473v2.566c.014 1.829.125 3.656.331 5.472 0 0 .322 2.33 1.316 3.36 1.26 1.345 2.916 1.3 3.653 1.445 2.65.26 11.263.34 11.263.34s6.96-.01 11.597-.353a4.691 4.691 0 0 0 3.32-1.432c.993-1.026 1.316-3.356 1.316-3.356.206-1.817.316-3.644.33-5.473v-2.57a52.26 52.26 0 0 0-.33-5.472zM14.076 17.232V7.729l8.951 4.768-8.95 4.735z"/></svg>	
        </a></li>
        <li><a href="https://www.linkedin.com/company/pytorch" target="_blank" title="PyTorch on LinkedIn">
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="-10.23 -10.23 531.96 531.96" aria-label="LinkedIn"><rect width="512" height="512" rx="0" fill="currentColor"/><circle fill="#000" cx="142" cy="138" r="37"/><path stroke="#000" stroke-width="66" d="M244 194v198M142 194v198"/><path fill="#000" d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
        </a></li>
        <li><a href="https://social.lfx.dev/@pytorch" rel="me" target="_blank" title="PyTorch on Mastodon">
          <svg fill="currentColor" aria-label="Mastodon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xml:space="preserve"><path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/></svg>
        </a></li>
      </ul>
    </div>

    <div class="privacy-policy">
      <div class="copyright">
        <p>© Copyright The Linux Foundation. The PyTorch Foundation is a project of The Linux Foundation. 
          For web site terms of use, trademark policy and other policies applicable to The PyTorch Foundation please see 
          <a href="https://www.linuxfoundation.org/legal/policies/">Linux Foundation Policies</a>. The PyTorch Foundation supports the PyTorch open source 
          project, which has been established as PyTorch Project a Series of LF Projects, LLC. For policies applicable to the PyTorch Project a Series of LF Projects, LLC, 
          please see <a href="https://www.lfprojects.org/policies/">LF Projects, LLC Policies</a>. <a href="https://www.linuxfoundation.org/privacy">Privacy Policy</a> and <a href="https://www.linuxfoundation.org/terms">Terms of Use</a>.</p>
      </div>
    </div>
  </div>
  <img height="1" width="1" style="border-style:none;" alt="" src="https://www.googleadservices.com/pagead/conversion/795629140/?label=txkmCPmdtosBENSssfsC&amp;guid=ON&amp;script=0"/>

</footer>

<div class="mobile-main-menu">
  <div class="container-fluid">
    <div class="container">
      <div class="mobile-main-menu-header-container">
        <a class="header-logo" href="https://pytorch.org" aria-label="PyTorch"></a>
        <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
      </div>
    </div>
  </div>

  <div class="mobile-main-menu-links-container">

    <div class="main-menu">
      <ul>
        <li class="navSearchWrapper reactNavSearchWrapper tabletSearchWrapper" key="search">
          <div class="mobile-search-border">
            <input
              id="mobile-search-input"
              type="text"
              title="Search"
            />
            <div id="mobile-search-icon"></div>
          </div>
        </li>

        <li class="resources-mobile-menu-title">
          <a>Learn</a>
        </li>
        <ul class="resources-mobile-menu-items">
          <li>
            <a href="/get-started">Get Started</a> 
          </li>
          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>
          <li>
            <a href="https://pytorch.org/tutorials/beginner/basics/intro.html">Learn the Basics</a>
          </li>
          <li>
            <a href="https://pytorch.org/tutorials/recipes/recipes_index.html">PyTorch Recipes</a>
          </li>
          <li>
            <a href="https://pytorch.org/tutorials/beginner/introyt.html">Introduction to PyTorch - YouTube Series</a>
          </li>
        </ul>
        <li class="resources-mobile-menu-title">
          <a>Ecosystem</a>
        </li>
        <ul class="resources-mobile-menu-items">
          <li>
            <a href="/ecosystem">Tools</a>
          </li>
          <li>
            <a href="/#community-module">Community</a>
          </li>
          <li>
            <a href="https://discuss.pytorch.org">Forums</a>
          </li>
          <li>
            <a href="/resources">Developer Resources</a>
          </li>
          <li>
            <a href="/ecosystem/contributor-awards-2023">Contributor Awards - 2023</a>
          </li>
        </ul>
        <li class="resources-mobile-menu-title">
          <a>Edge</a>
        </li>
        <ul class="resources-mobile-menu-items">
          <li>
            <a href="/edge">About PyTorch Edge</a>
          </li>
          <li>
            <a href="/executorch-overview">ExecuTorch</a>
          </li>
        </ul>
        <li class="resources-mobile-menu-title">
          <a>Docs</a>
        </li>
        <ul class="resources-mobile-menu-items">
          <li>
            <a href="https://pytorch.org/docs">PyTorch</a>
          </li>
          <li>
            <a href="/pytorch-domains">PyTorch Domains</a>
          </li>
        </ul>

        <li class="resources-mobile-menu-title">
          <a>Blog & News</a>
        </li>
        <ul class="resources-mobile-menu-items">
          <li>
            <a href="/blog">PyTorch Blog</a>
          </li>
          <li>
            <a href="/community-blog">Community Blog</a>
          </li>
          <li>
            <a href="/videos">Videos</a>
          </li>
          <li>
            <a href="/community-stories">Community Stories</a>
          </li>
          <li>
            <a href="/events">Events</a>
          </li>
        </ul>
        <li class="resources-mobile-menu-title">
          <a>About</a>
        </li>
        <ul class="resources-mobile-menu-items">
          <li>
            <a href="/foundation">PyTorch Foundation</a>
          </li>
          <li>
            <a href="/governing-board">Governing Board</a>
          </li>
        </ul>
        <li class="resources-mobile-menu-title">
          <a href="/join">Become a Member</a>
        </li>
        <li class="resources-mobile-menu-title">
          <a href="https://github.com/pytorch/pytorch" title="Go to PyTorch GitHub"><div id="topnav-gh-icon"></div></a>
        </li>

      </ul>
    </div>

  </div>
</div>


<script src="/assets/mobile-menu.js"></script>
<script src="/assets/scroll-to-anchor.js"></script>
<script src="/assets/external-links-new-tab.js"></script>

  <script src="/assets/search-bar.js"></script>

<script src="/assets/cookie-banner.js"></script>

<script type="text/javascript">
  mobileMenu.bind();
  anchors.add('.pytorch-article h2, .pytorch-article h3, .pytorch-article h4, .pytorch-article h5');

  // Add class to links that have code blocks, since we cannot create links in code blocks
  $("a code.highlighter-rouge").each(function(e) {
    $(this).closest("a").addClass("has-code");
  });

  scrollToAnchor.bind();

  var hasStaticHeader = $(".blog-header, .blog-detail-header, .resources-header, .get-started-header, .features-header, .ecosystem-header, .hub-header, .mobile-header, .announcement-header, .comm-stories-header").length > 0;

  if (!hasStaticHeader) {
    $(window).on("scroll", function() {
      var top = $(this).scrollTop();
      var fullPosition = $(".main-background").height() - $(".header-holder").height();

      if (top <= 40) {
        $(".header-holder").css({"backgroundColor": "rgba(0, 0, 0, 0.165)"});
      } else if (top >= fullPosition) {
        $(".header-holder").css({"backgroundColor": "#000000"});
      } else {
        var bgColor = "rgba(0, 0, 0, " + top / fullPosition + ")";
        $(".header-holder").css({"backgroundColor": bgColor});
      }
    });
  }
</script>


  <script src="/assets/track-events.js"></script>
  <script>trackEvents.bind();</script>



<div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="/assets/images/pytorch-x.svg">
  </div>
</div>


</body>

</html>
